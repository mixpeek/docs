<svg viewBox="0 0 1200 750" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <linearGradient id="sourceGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#6366f1;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#4f46e5;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="clusterGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#8b5cf6;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#7c3aed;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="artifactGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#f97316;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#ea580c;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="enrichGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#14b8a6;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#0d9488;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="taxonomyGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#ec4899;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#db2777;stop-opacity:1" />
    </linearGradient>
    
    <marker id="arrowGray" markerWidth="8" markerHeight="6" refX="7" refY="3" orient="auto">
      <polygon points="0 0, 8 3, 0 6" fill="#94a3b8"/>
    </marker>
    <marker id="arrowPurple" markerWidth="8" markerHeight="6" refX="7" refY="3" orient="auto">
      <polygon points="0 0, 8 3, 0 6" fill="#8b5cf6"/>
    </marker>
    <marker id="arrowTeal" markerWidth="8" markerHeight="6" refX="7" refY="3" orient="auto">
      <polygon points="0 0, 8 3, 0 6" fill="#14b8a6"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect width="1200" height="750" fill="none"/>
  
  <!-- Title -->
  <text x="600" y="40" font-family="system-ui, -apple-system, sans-serif" font-size="24" font-weight="600" fill="#f1f5f9" text-anchor="middle">Clusters: Discover Structure &amp; Enrich Documents</text>
  <text x="600" y="65" font-family="system-ui, sans-serif" font-size="13" fill="#94a3b8" text-anchor="middle">Group similar documents ‚Ä¢ Generate labels ‚Ä¢ Write enrichments back to collections</text>

  <!-- Step 1: Source Collection -->
  <text x="150" y="105" font-family="system-ui, sans-serif" font-size="12" font-weight="600" fill="#475569" text-anchor="middle">1. Source Documents</text>
  <g>
    <rect x="50" y="120" width="200" height="180" rx="10" fill="white" stroke="#334155" stroke-width="2"/>
    <rect x="50" y="120" width="200" height="28" rx="10" fill="url(#sourceGrad)"/>
    <rect x="50" y="138" width="200" height="10" fill="url(#sourceGrad)"/>
    <text x="150" y="140" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="white" text-anchor="middle">üìö Product Collection</text>
  </g>
  
  <!-- Document dots visualization -->
  <g transform="translate(70, 165)">
    <circle cx="20" cy="20" r="6" fill="#818cf8"/>
    <circle cx="45" cy="15" r="6" fill="#818cf8"/>
    <circle cx="35" cy="40" r="6" fill="#818cf8"/>
    <circle cx="80" cy="25" r="6" fill="#a78bfa"/>
    <circle cx="100" cy="35" r="6" fill="#a78bfa"/>
    <circle cx="90" cy="55" r="6" fill="#a78bfa"/>
    <circle cx="130" cy="20" r="6" fill="#c4b5fd"/>
    <circle cx="150" cy="40" r="6" fill="#c4b5fd"/>
    <circle cx="140" cy="60" r="6" fill="#c4b5fd"/>
    <circle cx="60" cy="70" r="6" fill="#818cf8"/>
    <circle cx="110" cy="75" r="6" fill="#a78bfa"/>
    <circle cx="40" cy="85" r="6" fill="#818cf8"/>
    <circle cx="155" cy="70" r="6" fill="#c4b5fd"/>
    <text x="80" y="110" font-family="system-ui, sans-serif" font-size="9" fill="#94a3b8" text-anchor="middle">Unclustered embeddings</text>
  </g>

  <!-- Arrow to Cluster Engine -->
  <path d="M 250 210 L 320 210" stroke="#94a3b8" stroke-width="2" fill="none" marker-end="url(#arrowGray)"/>

  <!-- Step 2: Cluster Engine -->
  <text x="470" y="105" font-family="system-ui, sans-serif" font-size="12" font-weight="600" fill="#475569" text-anchor="middle">2. Cluster Execution</text>
  <g>
    <rect x="330" y="120" width="280" height="180" rx="10" fill="white" stroke="#334155" stroke-width="2"/>
    <rect x="330" y="120" width="280" height="28" rx="10" fill="url(#clusterGrad)"/>
    <rect x="330" y="138" width="280" height="10" fill="url(#clusterGrad)"/>
    <text x="470" y="140" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="white" text-anchor="middle">‚öôÔ∏è Clustering Engine (Ray)</text>
  </g>
  
  <g transform="translate(345, 160)">
    <!-- Algorithm selection -->
    <rect x="0" y="0" width="120" height="60" rx="6" fill="#f3e8ff" stroke="#d8b4fe" stroke-width="1"/>
    <text x="60" y="16" font-family="system-ui, sans-serif" font-size="9" font-weight="600" fill="#7c3aed" text-anchor="middle">Algorithm</text>
    <text x="60" y="32" font-family="monospace" font-size="8" fill="#475569" text-anchor="middle">kmeans</text>
    <text x="60" y="44" font-family="monospace" font-size="8" fill="#475569" text-anchor="middle">num_clusters: 50</text>
    
    <!-- Dimension reduction -->
    <rect x="130" y="0" width="120" height="60" rx="6" fill="#f3e8ff" stroke="#d8b4fe" stroke-width="1"/>
    <text x="190" y="16" font-family="system-ui, sans-serif" font-size="9" font-weight="600" fill="#7c3aed" text-anchor="middle">Dim Reduction</text>
    <text x="190" y="32" font-family="monospace" font-size="8" fill="#475569" text-anchor="middle">method: umap</text>
    <text x="190" y="44" font-family="monospace" font-size="8" fill="#475569" text-anchor="middle">components: 2</text>
    
    <!-- LLM Labeling -->
    <rect x="0" y="70" width="250" height="50" rx="6" fill="#fef3c7" stroke="#fcd34d" stroke-width="1"/>
    <text x="125" y="88" font-family="system-ui, sans-serif" font-size="9" font-weight="600" fill="#92400e" text-anchor="middle">ü§ñ LLM Labeling</text>
    <text x="125" y="104" font-family="monospace" font-size="8" fill="#475569" text-anchor="middle">gpt-4o-mini ‚Üí labels, summaries, keywords</text>
  </g>

  <!-- Arrow to Artifacts -->
  <path d="M 610 210 L 680 210" stroke="#94a3b8" stroke-width="2" fill="none" marker-end="url(#arrowGray)"/>

  <!-- Step 3: Artifacts -->
  <text x="840" y="105" font-family="system-ui, sans-serif" font-size="12" font-weight="600" fill="#475569" text-anchor="middle">3. Artifacts (S3/Parquet)</text>
  <g>
    <rect x="690" y="120" width="300" height="180" rx="10" fill="white" stroke="#334155" stroke-width="2"/>
    <rect x="690" y="120" width="300" height="28" rx="10" fill="url(#artifactGrad)"/>
    <rect x="690" y="138" width="300" height="10" fill="url(#artifactGrad)"/>
    <text x="840" y="140" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="white" text-anchor="middle">üì¶ Cluster Artifacts</text>
  </g>
  
  <g transform="translate(705, 160)">
    <!-- Centroids -->
    <rect x="0" y="0" width="130" height="55" rx="6" fill="#fff7ed" stroke="#fdba74" stroke-width="1"/>
    <text x="65" y="16" font-family="system-ui, sans-serif" font-size="9" font-weight="600" fill="#c2410c" text-anchor="middle">Centroids</text>
    <text x="65" y="30" font-family="monospace" font-size="7" fill="#475569" text-anchor="middle">cluster_id, vector</text>
    <text x="65" y="42" font-family="monospace" font-size="7" fill="#475569" text-anchor="middle">label, summary, count</text>
    
    <!-- Members -->
    <rect x="140" y="0" width="130" height="55" rx="6" fill="#fff7ed" stroke="#fdba74" stroke-width="1"/>
    <text x="205" y="16" font-family="system-ui, sans-serif" font-size="9" font-weight="600" fill="#c2410c" text-anchor="middle">Members</text>
    <text x="205" y="30" font-family="monospace" font-size="7" fill="#475569" text-anchor="middle">point_id, cluster_id</text>
    <text x="205" y="42" font-family="monospace" font-size="7" fill="#475569" text-anchor="middle">x, y coordinates</text>
    
    <!-- Visualization preview -->
    <rect x="0" y="65" width="270" height="70" rx="6" fill="#fef3c7" stroke="#fcd34d" stroke-width="1"/>
    <text x="135" y="82" font-family="system-ui, sans-serif" font-size="9" font-weight="600" fill="#92400e" text-anchor="middle">üìä 2D Projection</text>
    <!-- Cluster visualization dots -->
    <circle cx="40" cy="105" r="4" fill="#818cf8"/>
    <circle cx="50" cy="115" r="4" fill="#818cf8"/>
    <circle cx="55" cy="100" r="4" fill="#818cf8"/>
    <circle cx="100" cy="110" r="4" fill="#f472b6"/>
    <circle cx="110" cy="100" r="4" fill="#f472b6"/>
    <circle cx="115" cy="118" r="4" fill="#f472b6"/>
    <circle cx="170" cy="105" r="4" fill="#34d399"/>
    <circle cx="180" cy="115" r="4" fill="#34d399"/>
    <circle cx="185" cy="98" r="4" fill="#34d399"/>
    <circle cx="230" cy="108" r="4" fill="#fbbf24"/>
    <circle cx="240" cy="100" r="4" fill="#fbbf24"/>
    <circle cx="245" cy="118" r="4" fill="#fbbf24"/>
  </g>

  <!-- Row 2: Enrichment and Taxonomy -->
  
  <!-- Arrow down from Artifacts -->
  <path d="M 840 300 L 840 340 L 400 340 L 400 380" stroke="#14b8a6" stroke-width="2" fill="none" marker-end="url(#arrowTeal)"/>
  <text x="620" y="335" font-family="system-ui, sans-serif" font-size="10" fill="#14b8a6" text-anchor="middle">Enrich documents with cluster metadata</text>

  <!-- Step 4: Enrichment -->
  <text x="400" y="370" font-family="system-ui, sans-serif" font-size="12" font-weight="600" fill="#475569" text-anchor="middle">4. Document Enrichment</text>
  <g>
    <rect x="200" y="390" width="400" height="200" rx="10" fill="white" stroke="#14b8a6" stroke-width="2"/>
    <rect x="200" y="390" width="400" height="28" rx="10" fill="url(#enrichGrad)"/>
    <rect x="200" y="408" width="400" height="10" fill="url(#enrichGrad)"/>
    <text x="400" y="410" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="white" text-anchor="middle">‚ú® Enriched Collection</text>
  </g>
  
  <g transform="translate(220, 435)">
    <!-- Original document -->
    <rect x="0" y="0" width="170" height="80" rx="6" fill="#f1f5f9" stroke="#cbd5e1" stroke-width="1"/>
    <text x="85" y="16" font-family="system-ui, sans-serif" font-size="9" font-weight="600" fill="#475569" text-anchor="middle">Original Document</text>
    <text x="10" y="34" font-family="monospace" font-size="8" fill="#94a3b8">doc_id: "prod_001"</text>
    <text x="10" y="48" font-family="monospace" font-size="8" fill="#94a3b8">title: "Wireless..."</text>
    <text x="10" y="62" font-family="monospace" font-size="8" fill="#94a3b8">embedding: [...]</text>
    
    <text x="185" y="40" font-family="system-ui, sans-serif" font-size="16" fill="#14b8a6">‚Üí</text>
    
    <!-- Enriched document -->
    <rect x="200" y="0" width="170" height="130" rx="6" fill="#f0fdfa" stroke="#14b8a6" stroke-width="1"/>
    <text x="285" y="16" font-family="system-ui, sans-serif" font-size="9" font-weight="600" fill="#0d9488" text-anchor="middle">+ Cluster Enrichment</text>
    <text x="210" y="34" font-family="monospace" font-size="8" fill="#115e59">doc_id: "prod_001"</text>
    <text x="210" y="48" font-family="monospace" font-size="8" fill="#115e59">title: "Wireless..."</text>
    <text x="210" y="62" font-family="monospace" font-size="8" fill="#115e59">embedding: [...]</text>
    <line x1="210" y1="68" x2="360" y2="68" stroke="#99f6e4" stroke-width="1"/>
    <text x="210" y="82" font-family="monospace" font-size="8" fill="#14b8a6">cluster_id: "clst_047"</text>
    <text x="210" y="96" font-family="monospace" font-size="8" fill="#14b8a6">label: "Audio Equipment"</text>
    <text x="210" y="110" font-family="monospace" font-size="8" fill="#14b8a6">keywords: ["wireless",</text>
    <text x="220" y="122" font-family="monospace" font-size="8" fill="#14b8a6">"bluetooth", "audio"]</text>
  </g>

  <!-- Arrow to Taxonomy (optional path) -->
  <path d="M 840 300 L 840 340 L 900 340 L 900 380" stroke="#ec4899" stroke-width="2" fill="none" stroke-dasharray="6,3" marker-end="url(#arrowGray)"/>
  <text x="920" y="335" font-family="system-ui, sans-serif" font-size="10" fill="#ec4899">Optional</text>

  <!-- Step 5: Taxonomy Promotion -->
  <text x="900" y="370" font-family="system-ui, sans-serif" font-size="12" font-weight="600" fill="#475569" text-anchor="middle">5. Promote to Taxonomy</text>
  <g>
    <rect x="700" y="390" width="400" height="200" rx="10" fill="white" stroke="#ec4899" stroke-width="2"/>
    <rect x="700" y="390" width="400" height="28" rx="10" fill="url(#taxonomyGrad)"/>
    <rect x="700" y="408" width="400" height="10" fill="url(#taxonomyGrad)"/>
    <text x="900" y="410" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="white" text-anchor="middle">üè∑Ô∏è Cluster ‚Üí Taxonomy Nodes</text>
  </g>
  
  <g transform="translate(720, 435)">
    <!-- Cluster nodes becoming taxonomy -->
    <rect x="0" y="0" width="160" height="70" rx="6" fill="#fce7f3" stroke="#f9a8d4" stroke-width="1"/>
    <text x="80" y="16" font-family="system-ui, sans-serif" font-size="9" font-weight="600" fill="#db2777" text-anchor="middle">Stable Clusters</text>
    <text x="80" y="34" font-family="system-ui, sans-serif" font-size="8" fill="#475569" text-anchor="middle">High coherence score</text>
    <text x="80" y="48" font-family="system-ui, sans-serif" font-size="8" fill="#475569" text-anchor="middle">Consistent membership</text>
    <text x="80" y="62" font-family="system-ui, sans-serif" font-size="8" fill="#475569" text-anchor="middle">Quality labels</text>
    
    <text x="175" y="35" font-family="system-ui, sans-serif" font-size="16" fill="#ec4899">‚Üí</text>
    
    <rect x="200" y="0" width="160" height="70" rx="6" fill="#fdf2f8" stroke="#ec4899" stroke-width="1"/>
    <text x="280" y="16" font-family="system-ui, sans-serif" font-size="9" font-weight="600" fill="#be185d" text-anchor="middle">Taxonomy Reference</text>
    <text x="280" y="34" font-family="system-ui, sans-serif" font-size="8" fill="#475569" text-anchor="middle">Reusable for new docs</text>
    <text x="280" y="48" font-family="system-ui, sans-serif" font-size="8" fill="#475569" text-anchor="middle">Similarity-based joins</text>
    <text x="280" y="62" font-family="system-ui, sans-serif" font-size="8" fill="#475569" text-anchor="middle">Hierarchical structure</text>
    
    <!-- Use case examples -->
    <rect x="0" y="85" width="360" height="55" rx="6" fill="#fef3c7" stroke="#fcd34d" stroke-width="1"/>
    <text x="180" y="102" font-family="system-ui, sans-serif" font-size="9" font-weight="600" fill="#92400e" text-anchor="middle">Use Cases</text>
    <text x="180" y="118" font-family="system-ui, sans-serif" font-size="8" fill="#475569" text-anchor="middle">Product categories ‚Ä¢ Content themes ‚Ä¢ User segments</text>
    <text x="180" y="132" font-family="system-ui, sans-serif" font-size="8" fill="#475569" text-anchor="middle">Topic modeling ‚Ä¢ Anomaly detection ‚Ä¢ Recommendation groups</text>
  </g>

  <!-- Algorithm options box -->
  <g>
    <rect x="50" y="380" width="130" height="170" rx="10" fill="#1e293b" stroke="#334155" stroke-width="1"/>
    <text x="115" y="402" font-family="system-ui, sans-serif" font-size="10" font-weight="600" fill="#94a3b8" text-anchor="middle">Algorithms</text>
    <line x1="50" y1="412" x2="180" y2="412" stroke="#334155" stroke-width="1"/>
  </g>
  <g transform="translate(60, 425)">
    <text x="0" y="12" font-family="monospace" font-size="9" fill="#7dd3fc">kmeans</text>
    <text x="0" y="26" font-family="monospace" font-size="9" fill="#7dd3fc">dbscan</text>
    <text x="0" y="40" font-family="monospace" font-size="9" fill="#7dd3fc">hdbscan</text>
    <text x="0" y="54" font-family="monospace" font-size="9" fill="#7dd3fc">agglomerative</text>
    <text x="0" y="68" font-family="monospace" font-size="9" fill="#7dd3fc">spectral</text>
    <text x="0" y="82" font-family="monospace" font-size="9" fill="#7dd3fc">gaussian_mixture</text>
    <text x="0" y="96" font-family="monospace" font-size="9" fill="#7dd3fc">mean_shift</text>
    <text x="0" y="110" font-family="monospace" font-size="9" fill="#7dd3fc">optics</text>
  </g>

  <!-- Legend -->
  <g transform="translate(100, 710)">
    <rect x="0" y="0" width="12" height="12" rx="2" fill="url(#sourceGrad)"/>
    <text x="18" y="11" font-family="system-ui, sans-serif" font-size="10" fill="#475569">Source Collection</text>
    
    <rect x="140" y="0" width="12" height="12" rx="2" fill="url(#clusterGrad)"/>
    <text x="158" y="11" font-family="system-ui, sans-serif" font-size="10" fill="#475569">Cluster Engine</text>
    
    <rect x="280" y="0" width="12" height="12" rx="2" fill="url(#artifactGrad)"/>
    <text x="298" y="11" font-family="system-ui, sans-serif" font-size="10" fill="#475569">Artifacts</text>
    
    <rect x="380" y="0" width="12" height="12" rx="2" fill="url(#enrichGrad)"/>
    <text x="398" y="11" font-family="system-ui, sans-serif" font-size="10" fill="#475569">Enrichment</text>
    
    <rect x="490" y="0" width="12" height="12" rx="2" fill="url(#taxonomyGrad)"/>
    <text x="508" y="11" font-family="system-ui, sans-serif" font-size="10" fill="#475569">Taxonomy (Optional)</text>
    
    <line x1="650" y1="6" x2="690" y2="6" stroke="#94a3b8" stroke-width="2" marker-end="url(#arrowGray)"/>
    <text x="700" y="11" font-family="system-ui, sans-serif" font-size="10" fill="#475569">Data flow</text>
    
    <line x1="780" y1="6" x2="820" y2="6" stroke="#ec4899" stroke-width="2" stroke-dasharray="6,3"/>
    <text x="830" y="11" font-family="system-ui, sans-serif" font-size="10" fill="#475569">Optional path</text>
  </g>

</svg>