<svg viewBox="0 0 1200 850" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <linearGradient id="objectGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#f97316;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#ea580c;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="rayGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#6366f1;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#4f46e5;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="modelGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#8b5cf6;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#7c3aed;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="featureGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#14b8a6;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#0d9488;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="qdrantGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#ec4899;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#db2777;stop-opacity:1" />
    </linearGradient>
    
    <marker id="arrowGray" markerWidth="8" markerHeight="6" refX="7" refY="3" orient="auto">
      <polygon points="0 0, 8 3, 0 6" fill="#94a3b8"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect width="1200" height="850" fill="none"/>
  
  <!-- Title -->
  <text x="600" y="40" font-family="system-ui, -apple-system, sans-serif" font-size="24" font-weight="600" fill="#f1f5f9" text-anchor="middle">Feature Extractors: Distributed Inference Batch Pipelines</text>
  <text x="600" y="65" font-family="system-ui, sans-serif" font-size="13" fill="#94a3b8" text-anchor="middle">Turn raw objects into reusable features with stable URIs</text>

  <!-- Stage 1: Source Objects -->
  <text x="150" y="100" font-family="system-ui, sans-serif" font-size="12" font-weight="600" fill="#475569" text-anchor="middle">1. Source Objects</text>
  <g>
    <rect x="50" y="115" width="200" height="140" rx="10" fill="white" stroke="#334155" stroke-width="2"/>
    <rect x="50" y="115" width="200" height="28" rx="10" fill="url(#objectGrad)"/>
    <rect x="50" y="133" width="200" height="10" fill="url(#objectGrad)"/>
    <text x="150" y="135" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="white" text-anchor="middle">ğŸ“¦ Bucket Objects</text>
  </g>
  <g transform="translate(65, 155)">
    <rect x="0" y="0" width="170" height="28" rx="4" fill="#fff7ed"/>
    <text x="12" y="12" font-family="system-ui, sans-serif" font-size="8" fill="#c2410c">ğŸ¬</text>
    <text x="28" y="12" font-family="monospace" font-size="8" fill="#475569">video/mp4</text>
    <text x="28" y="22" font-family="monospace" font-size="7" fill="#94a3b8">marketing_video.mp4</text>
    
    <rect x="0" y="32" width="170" height="28" rx="4" fill="#fff7ed"/>
    <text x="12" y="44" font-family="system-ui, sans-serif" font-size="8" fill="#c2410c">ğŸ–¼</text>
    <text x="28" y="44" font-family="monospace" font-size="8" fill="#475569">image/jpeg</text>
    <text x="28" y="54" font-family="monospace" font-size="7" fill="#94a3b8">product_photo.jpg</text>
    
    <rect x="0" y="64" width="170" height="28" rx="4" fill="#fff7ed"/>
    <text x="12" y="76" font-family="system-ui, sans-serif" font-size="8" fill="#c2410c">ğŸ“„</text>
    <text x="28" y="76" font-family="monospace" font-size="8" fill="#475569">text/plain</text>
    <text x="28" y="86" font-family="monospace" font-size="7" fill="#94a3b8">description.txt</text>
  </g>

  <!-- Arrow to Ray -->
  <path d="M 250 185 L 290 185" stroke="#94a3b8" stroke-width="2" fill="none" marker-end="url(#arrowGray)"/>

  <!-- Stage 2: Ray Engine -->
  <text x="450" y="100" font-family="system-ui, sans-serif" font-size="12" font-weight="600" fill="#475569" text-anchor="middle">2. Engine</text>
  <g>
    <rect x="300" y="115" width="300" height="140" rx="10" fill="white" stroke="#334155" stroke-width="2"/>
    <rect x="300" y="115" width="300" height="28" rx="10" fill="url(#rayGrad)"/>
    <rect x="300" y="133" width="300" height="10" fill="url(#rayGrad)"/>
    <text x="450" y="135" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="white" text-anchor="middle">âš¡ Distributed Processing</text>
  </g>
  <g transform="translate(315, 155)">
    <rect x="0" y="0" width="130" height="40" rx="6" fill="#eef2ff" stroke="#c7d2fe" stroke-width="1"/>
    <text x="65" y="16" font-family="system-ui, sans-serif" font-size="9" font-weight="600" fill="#4338ca" text-anchor="middle">Manifest</text>
    <text x="65" y="30" font-family="monospace" font-size="7" fill="#475569" text-anchor="middle">Parquet artifacts in S3</text>
    
    <rect x="140" y="0" width="130" height="40" rx="6" fill="#eef2ff" stroke="#c7d2fe" stroke-width="1"/>
    <text x="205" y="16" font-family="system-ui, sans-serif" font-size="9" font-weight="600" fill="#4338ca" text-anchor="middle">Ray Workers</text>
    <text x="205" y="30" font-family="monospace" font-size="7" fill="#475569" text-anchor="middle">GPU: 5-10Ã— throughput</text>
    
    <rect x="0" y="50" width="270" height="40" rx="6" fill="#fef3c7" stroke="#fcd34d" stroke-width="1"/>
    <text x="135" y="66" font-family="system-ui, sans-serif" font-size="9" font-weight="600" fill="#92400e" text-anchor="middle">Autoscaling: CPU 0.7 target â€¢ GPU 0.8 target</text>
    <text x="135" y="80" font-family="monospace" font-size="7" fill="#475569" text-anchor="middle">Batching, shuffling, parallelization automatic</text>
  </g>

  <!-- Arrow to Models -->
  <path d="M 600 185 L 640 185" stroke="#94a3b8" stroke-width="2" fill="none" marker-end="url(#arrowGray)"/>

  <!-- Stage 3: ML Models -->
  <text x="850" y="100" font-family="system-ui, sans-serif" font-size="12" font-weight="600" fill="#475569" text-anchor="middle">3. ML Models</text>
  <g>
    <rect x="650" y="115" width="400" height="140" rx="10" fill="white" stroke="#334155" stroke-width="2"/>
    <rect x="650" y="115" width="400" height="28" rx="10" fill="url(#modelGrad)"/>
    <rect x="650" y="133" width="400" height="10" fill="url(#modelGrad)"/>
    <text x="850" y="135" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="white" text-anchor="middle">ğŸ§  Model Inference</text>
  </g>
  <g transform="translate(665, 155)">
    <!-- Whisper -->
    <rect x="0" y="0" width="115" height="85" rx="6" fill="#f3e8ff" stroke="#d8b4fe" stroke-width="1"/>
    <text x="57" y="16" font-family="system-ui, sans-serif" font-size="9" font-weight="600" fill="#7c3aed" text-anchor="middle">ğŸ™ Whisper</text>
    <text x="57" y="32" font-family="monospace" font-size="7" fill="#475569" text-anchor="middle">large-v3-turbo</text>
    <text x="57" y="46" font-family="system-ui, sans-serif" font-size="7" fill="#94a3b8" text-anchor="middle">Audio â†’ Text</text>
    <rect x="10" y="54" width="95" height="24" rx="3" fill="#ede9fe"/>
    <text x="57" y="70" font-family="monospace" font-size="7" fill="#6d28d9" text-anchor="middle">transcription</text>
    
    <!-- E5 -->
    <rect x="125" y="0" width="115" height="85" rx="6" fill="#f3e8ff" stroke="#d8b4fe" stroke-width="1"/>
    <text x="182" y="16" font-family="system-ui, sans-serif" font-size="9" font-weight="600" fill="#7c3aed" text-anchor="middle">ğŸ“ E5-Large</text>
    <text x="182" y="32" font-family="monospace" font-size="7" fill="#475569" text-anchor="middle">multilingual</text>
    <text x="182" y="46" font-family="system-ui, sans-serif" font-size="7" fill="#94a3b8" text-anchor="middle">Text â†’ 1024d</text>
    <rect x="135" y="54" width="95" height="24" rx="3" fill="#ede9fe"/>
    <text x="182" y="70" font-family="monospace" font-size="7" fill="#6d28d9" text-anchor="middle">text_embedding</text>
    
    <!-- Vertex -->
    <rect x="250" y="0" width="115" height="85" rx="6" fill="#f3e8ff" stroke="#d8b4fe" stroke-width="1"/>
    <text x="307" y="16" font-family="system-ui, sans-serif" font-size="9" font-weight="600" fill="#7c3aed" text-anchor="middle">ğŸŒ Vertex AI</text>
    <text x="307" y="32" font-family="monospace" font-size="7" fill="#475569" text-anchor="middle">multimodal</text>
    <text x="307" y="46" font-family="system-ui, sans-serif" font-size="7" fill="#94a3b8" text-anchor="middle">Any â†’ 1408d</text>
    <rect x="260" y="54" width="95" height="24" rx="3" fill="#ede9fe"/>
    <text x="307" y="70" font-family="monospace" font-size="7" fill="#6d28d9" text-anchor="middle">multimodal_emb</text>
  </g>

  <!-- Multimodal Extractor Example (center) -->
  <text x="600" y="290" font-family="system-ui, sans-serif" font-size="14" font-weight="600" fill="#475569" text-anchor="middle">Example: multimodal_extractor@v1 Pipeline</text>
  
  <g>
    <rect x="100" y="310" width="1000" height="220" rx="12" fill="white" stroke="#334155" stroke-width="2"/>
  </g>

  <!-- Pipeline stages -->
  <g transform="translate(120, 330)">
    <!-- Input -->
    <rect x="0" y="0" width="100" height="60" rx="8" fill="url(#objectGrad)"/>
    <text x="50" y="25" font-family="system-ui, sans-serif" font-size="10" font-weight="600" fill="white" text-anchor="middle">ğŸ“¦ Video</text>
    <text x="50" y="42" font-family="system-ui, sans-serif" font-size="8" fill="white" text-anchor="middle">120s MP4</text>
    
    <path d="M 100 30 L 130 30" stroke="#94a3b8" stroke-width="2" fill="none" marker-end="url(#arrowGray)"/>
    
    <!-- FFmpeg -->
    <rect x="140" y="0" width="110" height="60" rx="8" fill="#1e293b"/>
    <text x="195" y="22" font-family="system-ui, sans-serif" font-size="10" font-weight="600" fill="white" text-anchor="middle">ğŸ¬ FFmpeg</text>
    <text x="195" y="38" font-family="monospace" font-size="7" fill="#94a3b8" text-anchor="middle">scene_detection</text>
    <text x="195" y="50" font-family="monospace" font-size="7" fill="#22d3ee" text-anchor="middle">â†’ 8 chunks</text>
    
    <path d="M 250 30 L 280 30" stroke="#94a3b8" stroke-width="2" fill="none" marker-end="url(#arrowGray)"/>
    
    <!-- Parallel branches indicator -->
    <rect x="290" y="-20" width="320" height="100" rx="8" fill="#f1f5f9" stroke="#cbd5e1" stroke-width="1" stroke-dasharray="4,2"/>
    <text x="450" y="-5" font-family="system-ui, sans-serif" font-size="9" font-weight="600" fill="#94a3b8" text-anchor="middle">âš¡ Parallel Branches</text>
    
    <!-- Branch 1: Whisper + E5 -->
    <rect x="300" y="5" width="140" height="65" rx="6" fill="#fef3c7" stroke="#fcd34d" stroke-width="1"/>
    <text x="370" y="22" font-family="system-ui, sans-serif" font-size="9" font-weight="600" fill="#92400e" text-anchor="middle">Branch 1: Audio</text>
    <text x="370" y="38" font-family="monospace" font-size="7" fill="#475569" text-anchor="middle">Whisper â†’ E5</text>
    <text x="370" y="52" font-family="monospace" font-size="7" fill="#475569" text-anchor="middle">transcription_emb</text>
    <rect x="310" y="56" width="120" height="10" rx="2" fill="#fde68a"/>
    
    <!-- Branch 2: Vertex -->
    <rect x="460" y="5" width="140" height="65" rx="6" fill="#dbeafe" stroke="#93c5fd" stroke-width="1"/>
    <text x="530" y="22" font-family="system-ui, sans-serif" font-size="9" font-weight="600" fill="#1d4ed8" text-anchor="middle">Branch 2: Visual</text>
    <text x="530" y="38" font-family="monospace" font-size="7" fill="#475569" text-anchor="middle">Vertex Multimodal</text>
    <text x="530" y="52" font-family="monospace" font-size="7" fill="#475569" text-anchor="middle">multimodal_emb</text>
    <rect x="470" y="56" width="120" height="10" rx="2" fill="#bfdbfe"/>
    
    <path d="M 610 30 L 640 30" stroke="#94a3b8" stroke-width="2" fill="none" marker-end="url(#arrowGray)"/>
    
    <!-- Thumbnails -->
    <rect x="650" y="0" width="100" height="60" rx="8" fill="#1e293b"/>
    <text x="700" y="22" font-family="system-ui, sans-serif" font-size="10" font-weight="600" fill="white" text-anchor="middle">ğŸ–¼ Thumbnail</text>
    <text x="700" y="38" font-family="monospace" font-size="7" fill="#94a3b8" text-anchor="middle">per chunk</text>
    <text x="700" y="50" font-family="monospace" font-size="7" fill="#22d3ee" text-anchor="middle">â†’ S3 URLs</text>
    
    <path d="M 750 30 L 780 30" stroke="#94a3b8" stroke-width="2" fill="none" marker-end="url(#arrowGray)"/>
    
    <!-- Gemini -->
    <rect x="790" y="0" width="100" height="60" rx="8" fill="#1e293b"/>
    <text x="840" y="22" font-family="system-ui, sans-serif" font-size="10" font-weight="600" fill="white" text-anchor="middle">âœ¨ Gemini</text>
    <text x="840" y="38" font-family="monospace" font-size="7" fill="#94a3b8" text-anchor="middle">description+OCR</text>
    <text x="840" y="50" font-family="monospace" font-size="7" fill="#22d3ee" text-anchor="middle">â†’ text fields</text>
    
    <path d="M 890 30 L 920 30" stroke="#94a3b8" stroke-width="2" fill="none" marker-end="url(#arrowGray)"/>
    
    <!-- Output -->
    <rect x="930" y="0" width="100" height="60" rx="8" fill="url(#featureGrad)"/>
    <text x="980" y="25" font-family="system-ui, sans-serif" font-size="10" font-weight="600" fill="white" text-anchor="middle">âœ… Features</text>
    <text x="980" y="42" font-family="system-ui, sans-serif" font-size="8" fill="white" text-anchor="middle">8 documents</text>
  </g>

  <!-- Output URIs -->
  <g transform="translate(120, 430)">
    <text x="0" y="12" font-family="system-ui, sans-serif" font-size="10" font-weight="600" fill="#475569">Feature URIs produced:</text>
    <rect x="180" y="0" width="280" height="20" rx="4" fill="#f0fdfa" stroke="#14b8a6" stroke-width="1"/>
    <text x="320" y="14" font-family="monospace" font-size="8" fill="#0d9488" text-anchor="middle">mixpeek://multimodal_extractor@v1/multimodal_embedding</text>
    
    <rect x="480" y="0" width="300" height="20" rx="4" fill="#f0fdfa" stroke="#14b8a6" stroke-width="1"/>
    <text x="630" y="14" font-family="monospace" font-size="8" fill="#0d9488" text-anchor="middle">mixpeek://multimodal_extractor@v1/transcription_embedding</text>
    
    <rect x="800" y="0" width="160" height="20" rx="4" fill="#f0fdfa" stroke="#14b8a6" stroke-width="1"/>
    <text x="880" y="14" font-family="monospace" font-size="8" fill="#0d9488" text-anchor="middle">+ description, ocr_text</text>
  </g>

  <!-- Lineage metadata -->
  <g transform="translate(120, 465)">
    <text x="0" y="12" font-family="system-ui, sans-serif" font-size="10" font-weight="600" fill="#475569">Each document includes lineage:</text>
    <rect x="200" y="0" width="760" height="20" rx="4" fill="#f1f5f9"/>
    <text x="580" y="14" font-family="monospace" font-size="8" fill="#94a3b8" text-anchor="middle">root_object_id: "obj_123" | source_collection_id: "col_src" | processing_tier: 1 | feature_address: "mixpeek://..."</text>
  </g>

  <!-- Stage 4: Qdrant Storage -->
  <!-- <text x="600" y="530" font-family="system-ui, sans-serif" font-size="12" font-weight="600" fill="#475569" text-anchor="middle">4. Storage &amp; Indexing</text> -->
  
  <g>
    <rect x="200" y="545" width="350" height="150" rx="10" fill="white" stroke="#334155" stroke-width="2"/>
    <rect x="200" y="545" width="350" height="28" rx="10" fill="url(#qdrantGrad)"/>
    <rect x="200" y="563" width="350" height="10" fill="url(#qdrantGrad)"/>
    <text x="375" y="565" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="white" text-anchor="middle">ğŸ”® Vector Store</text>
  </g>
  <g transform="translate(215, 585)">
    <rect x="0" y="0" width="155" height="50" rx="6" fill="#fce7f3" stroke="#f9a8d4" stroke-width="1"/>
    <text x="77" y="18" font-family="system-ui, sans-serif" font-size="9" font-weight="600" fill="#db2777" text-anchor="middle">Vectors</text>
    <text x="77" y="32" font-family="monospace" font-size="7" fill="#475569" text-anchor="middle">multimodal: 1408d</text>
    <text x="77" y="44" font-family="monospace" font-size="7" fill="#475569" text-anchor="middle">transcription: 1024d</text>
    
    <rect x="165" y="0" width="155" height="50" rx="6" fill="#fce7f3" stroke="#f9a8d4" stroke-width="1"/>
    <text x="242" y="18" font-family="system-ui, sans-serif" font-size="9" font-weight="600" fill="#db2777" text-anchor="middle">Payloads</text>
    <text x="242" y="32" font-family="monospace" font-size="7" fill="#475569" text-anchor="middle">description, ocr_text</text>
    <text x="242" y="44" font-family="monospace" font-size="7" fill="#475569" text-anchor="middle">thumbnail_url, metadata</text>
    
    <rect x="0" y="58" width="320" height="40" rx="6" fill="#fef3c7" stroke="#fcd34d" stroke-width="1"/>
    <text x="160" y="76" font-family="system-ui, sans-serif" font-size="9" font-weight="600" fill="#92400e" text-anchor="middle">Index Signatures</text>
    <text x="160" y="90" font-family="monospace" font-size="7" fill="#475569" text-anchor="middle">Automatic cache invalidation on schema changes</text>
  </g>

  <g>
    <rect x="650" y="545" width="350" height="150" rx="10" fill="white" stroke="#334155" stroke-width="2"/>
    <rect x="650" y="545" width="350" height="28" rx="10" fill="#334155"/>
    <rect x="650" y="563" width="350" height="10" fill="#334155"/>
    <text x="825" y="565" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="white" text-anchor="middle">ğŸ—„ Metadata Store</text>
  </g>
  <g transform="translate(665, 585)">
    <rect x="0" y="0" width="155" height="50" rx="6" fill="#f1f5f9" stroke="#cbd5e1" stroke-width="1"/>
    <text x="77" y="18" font-family="system-ui, sans-serif" font-size="9" font-weight="600" fill="#475569" text-anchor="middle">Documents</text>
    <text x="77" y="32" font-family="monospace" font-size="7" fill="#94a3b8" text-anchor="middle">Full payloads</text>
    <text x="77" y="44" font-family="monospace" font-size="7" fill="#94a3b8" text-anchor="middle">Lineage metadata</text>
    
    <rect x="165" y="0" width="155" height="50" rx="6" fill="#f1f5f9" stroke="#cbd5e1" stroke-width="1"/>
    <text x="242" y="18" font-family="system-ui, sans-serif" font-size="9" font-weight="600" fill="#475569" text-anchor="middle">Collections</text>
    <text x="242" y="32" font-family="monospace" font-size="7" fill="#94a3b8" text-anchor="middle">output_schema</text>
    <text x="242" y="44" font-family="monospace" font-size="7" fill="#94a3b8" text-anchor="middle">extractor_config</text>
    
    <rect x="0" y="58" width="320" height="40" rx="6" fill="#dbeafe" stroke="#93c5fd" stroke-width="1"/>
    <text x="160" y="76" font-family="system-ui, sans-serif" font-size="9" font-weight="600" fill="#1d4ed8" text-anchor="middle">Webhooks</text>
    <text x="160" y="90" font-family="monospace" font-size="7" fill="#475569" text-anchor="middle">document.created, batch.completed events</text>
  </g>

  <!-- Available Extractors -->
  <g>
    <rect x="100" y="720" width="1000" height="100" rx="10" fill="#1e293b" stroke="#334155" stroke-width="1"/>
    <text x="600" y="745" font-family="system-ui, sans-serif" font-size="12" font-weight="600" fill="white" text-anchor="middle">Available Extractors</text>
    <line x1="100" y1="755" x2="1100" y2="755" stroke="#334155" stroke-width="1"/>
  </g>
  
  <g transform="translate(120, 770)">
    <!-- passthrough -->
    <rect x="0" y="0" width="200" height="40" rx="6" fill="#374151"/>
    <text x="100" y="16" font-family="monospace" font-size="9" fill="#7dd3fc" text-anchor="middle">passthrough_extractor_v1</text>
    <text x="100" y="32" font-family="system-ui, sans-serif" font-size="8" fill="#94a3b8" text-anchor="middle">Copy fields without processing</text>
    
    <!-- text -->
    <rect x="220" y="0" width="250" height="40" rx="6" fill="#374151"/>
    <text x="345" y="16" font-family="monospace" font-size="9" fill="#7dd3fc" text-anchor="middle">text_extractor_v1</text>
    <text x="345" y="32" font-family="system-ui, sans-serif" font-size="8" fill="#94a3b8" text-anchor="middle">E5-Large multilingual â€¢ 1024d â€¢ ~5ms</text>
    
    <!-- multimodal -->
    <rect x="490" y="0" width="300" height="40" rx="6" fill="#374151"/>
    <text x="640" y="16" font-family="monospace" font-size="9" fill="#7dd3fc" text-anchor="middle">multimodal_extractor_v1</text>
    <text x="640" y="32" font-family="system-ui, sans-serif" font-size="8" fill="#94a3b8" text-anchor="middle">Vertex AI â€¢ video/image/text â€¢ 1408d â€¢ 0.5-2Ã— RT</text>
    
    <!-- custom -->
    <rect x="810" y="0" width="160" height="40" rx="6" fill="#374151" stroke="#6366f1" stroke-width="1" stroke-dasharray="4,2"/>
    <text x="890" y="16" font-family="monospace" font-size="9" fill="#a5b4fc" text-anchor="middle">custom_extractor</text>
    <text x="890" y="32" font-family="system-ui, sans-serif" font-size="8" fill="#94a3b8" text-anchor="middle">Contact support</text>
  </g>

</svg>