<svg viewBox="0 0 1200 900" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <linearGradient id="objectGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#f97316;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#ea580c;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="tier1Grad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#6366f1;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#4f46e5;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="tier2Grad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#8b5cf6;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#7c3aed;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="tier3Grad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#ec4899;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#db2777;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="tier4Grad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#14b8a6;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#0d9488;stop-opacity:1" />
    </linearGradient>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="0" dy="4" stdDeviation="6" flood-opacity="0.15"/>
    </filter>
    <marker id="arrowGray" markerWidth="8" markerHeight="6" refX="7" refY="3" orient="auto">
      <polygon points="0 0, 8 3, 0 6" fill="#94a3b8"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect width="1200" height="900" fill="#f8fafc"/>
  
  <!-- Title -->
  <text x="600" y="40" font-family="system-ui, -apple-system, sans-serif" font-size="24" font-weight="600" fill="#0f172a" text-anchor="middle">Processing Pipelines: Tiered DAG Execution</text>
  <text x="600" y="65" font-family="system-ui, sans-serif" font-size="13" fill="#64748b" text-anchor="middle">Chain collections into multi-tier extraction workflows â€¢ Parallel execution within tiers</text>

  <!-- Tier Labels on left -->
  <g transform="translate(30, 0)">
    <text x="0" y="155" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="#ea580c">Source</text>
    <text x="0" y="295" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="#4f46e5">Tier 1</text>
    <text x="0" y="475" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="#7c3aed">Tier 2</text>
    <text x="0" y="655" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="#db2777">Tier 3</text>
    <text x="0" y="815" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="#0d9488">Tier 4</text>
  </g>

  <!-- Tier divider lines -->
  <line x1="70" y1="210" x2="1170" y2="210" stroke="#e2e8f0" stroke-width="1" stroke-dasharray="4,4"/>
  <line x1="70" y1="380" x2="1170" y2="380" stroke="#e2e8f0" stroke-width="1" stroke-dasharray="4,4"/>
  <line x1="70" y1="570" x2="1170" y2="570" stroke="#e2e8f0" stroke-width="1" stroke-dasharray="4,4"/>
  <line x1="70" y1="740" x2="1170" y2="740" stroke="#e2e8f0" stroke-width="1" stroke-dasharray="4,4"/>

  <!-- Source Object -->
  <g filter="url(#shadow)">
    <rect x="480" y="100" width="240" height="90" rx="10" fill="white" stroke="#e2e8f0" stroke-width="2"/>
    <rect x="480" y="100" width="240" height="28" rx="10" fill="url(#objectGrad)"/>
    <rect x="480" y="118" width="240" height="10" fill="url(#objectGrad)"/>
    <text x="600" y="120" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="white" text-anchor="middle">ğŸ“¦ Marketing Video</text>
  </g>
  <g transform="translate(495, 140)">
    <text x="0" y="12" font-family="monospace" font-size="9" fill="#475569">bucket_id: bkt_marketing</text>
    <text x="0" y="24" font-family="monospace" font-size="9" fill="#475569">video_url: s3://videos/ad.mp4</text>
    <text x="0" y="36" font-family="monospace" font-size="9" fill="#475569">duration: 120s</text>
  </g>

  <!-- Tier 1 Collections -->
  <!-- Video Scenes -->
  <path d="M 540 190 L 540 210 L 300 210 L 300 230" stroke="#94a3b8" stroke-width="2" fill="none" marker-end="url(#arrowGray)"/>
  <g filter="url(#shadow)">
    <rect x="170" y="235" width="260" height="95" rx="10" fill="white" stroke="#e2e8f0" stroke-width="2"/>
    <rect x="170" y="235" width="260" height="28" rx="10" fill="url(#tier1Grad)"/>
    <rect x="170" y="253" width="260" height="10" fill="url(#tier1Grad)"/>
    <text x="300" y="255" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="white" text-anchor="middle">ğŸ¬ Video Scenes</text>
  </g>
  <g transform="translate(185, 275)">
    <text x="0" y="12" font-family="monospace" font-size="9" fill="#6366f1">video_extractor@v1</text>
    <text x="0" y="24" font-family="monospace" font-size="9" fill="#475569">scene_detection: true</text>
    <rect x="0" y="32" width="230" height="18" rx="4" fill="#eef2ff"/>
    <text x="115" y="45" font-family="system-ui, sans-serif" font-size="9" fill="#4338ca" text-anchor="middle">â†’ 8 scene documents</text>
  </g>

  <!-- Audio Transcript -->
  <path d="M 660 190 L 660 210 L 900 210 L 900 230" stroke="#94a3b8" stroke-width="2" fill="none" marker-end="url(#arrowGray)"/>
  <g filter="url(#shadow)">
    <rect x="770" y="235" width="260" height="95" rx="10" fill="white" stroke="#e2e8f0" stroke-width="2"/>
    <rect x="770" y="235" width="260" height="28" rx="10" fill="url(#tier1Grad)"/>
    <rect x="770" y="253" width="260" height="10" fill="url(#tier1Grad)"/>
    <text x="900" y="255" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="white" text-anchor="middle">ğŸ™ Audio Transcript</text>
  </g>
  <g transform="translate(785, 275)">
    <text x="0" y="12" font-family="monospace" font-size="9" fill="#6366f1">audio_extractor@v1</text>
    <text x="0" y="24" font-family="monospace" font-size="9" fill="#475569">whisper-large-v3</text>
    <rect x="0" y="32" width="230" height="18" rx="4" fill="#eef2ff"/>
    <text x="115" y="45" font-family="system-ui, sans-serif" font-size="9" fill="#4338ca" text-anchor="middle">â†’ 1 transcript document</text>
  </g>

  <!-- Tier 2 Collections -->
  <!-- Scene Faces -->
  <path d="M 250 330 L 250 380 L 150 380 L 150 400" stroke="#94a3b8" stroke-width="2" fill="none" marker-end="url(#arrowGray)"/>
  <g filter="url(#shadow)">
    <rect x="80" y="405" width="140" height="90" rx="8" fill="white" stroke="#e2e8f0" stroke-width="2"/>
    <rect x="80" y="405" width="140" height="24" rx="8" fill="url(#tier2Grad)"/>
    <rect x="80" y="421" width="140" height="8" fill="url(#tier2Grad)"/>
    <text x="150" y="422" font-family="system-ui, sans-serif" font-size="10" font-weight="600" fill="white" text-anchor="middle">ğŸ‘¤ Scene Faces</text>
  </g>
  <g transform="translate(90, 445)">
    <text x="0" y="10" font-family="monospace" font-size="8" fill="#8b5cf6">face_detector@v2</text>
    <text x="0" y="22" font-family="monospace" font-size="8" fill="#475569">face_detection</text>
    <rect x="0" y="28" width="120" height="14" rx="3" fill="#f3e8ff"/>
    <text x="60" y="39" font-family="system-ui, sans-serif" font-size="8" fill="#7c3aed" text-anchor="middle">â†’ 12 faces</text>
  </g>

  <!-- Scene Objects -->
  <path d="M 300 330 L 300 380 L 300 400" stroke="#94a3b8" stroke-width="2" fill="none" marker-end="url(#arrowGray)"/>
  <g filter="url(#shadow)">
    <rect x="230" y="405" width="140" height="90" rx="8" fill="white" stroke="#e2e8f0" stroke-width="2"/>
    <rect x="230" y="405" width="140" height="24" rx="8" fill="url(#tier2Grad)"/>
    <rect x="230" y="421" width="140" height="8" fill="url(#tier2Grad)"/>
    <text x="300" y="422" font-family="system-ui, sans-serif" font-size="10" font-weight="600" fill="white" text-anchor="middle">ğŸ“¦ Scene Objects</text>
  </g>
  <g transform="translate(240, 445)">
    <text x="0" y="10" font-family="monospace" font-size="8" fill="#8b5cf6">object_detector@v1</text>
    <text x="0" y="22" font-family="monospace" font-size="8" fill="#475569">yolo_detection</text>
    <rect x="0" y="28" width="120" height="14" rx="3" fill="#f3e8ff"/>
    <text x="60" y="39" font-family="system-ui, sans-serif" font-size="8" fill="#7c3aed" text-anchor="middle">â†’ 45 objects</text>
  </g>

  <!-- Scene Text -->
  <path d="M 350 330 L 350 380 L 450 380 L 450 400" stroke="#94a3b8" stroke-width="2" fill="none" marker-end="url(#arrowGray)"/>
  <g filter="url(#shadow)">
    <rect x="380" y="405" width="140" height="90" rx="8" fill="white" stroke="#e2e8f0" stroke-width="2"/>
    <rect x="380" y="405" width="140" height="24" rx="8" fill="url(#tier2Grad)"/>
    <rect x="380" y="421" width="140" height="8" fill="url(#tier2Grad)"/>
    <text x="450" y="422" font-family="system-ui, sans-serif" font-size="10" font-weight="600" fill="white" text-anchor="middle">ğŸ“ Scene Text</text>
  </g>
  <g transform="translate(390, 445)">
    <text x="0" y="10" font-family="monospace" font-size="8" fill="#8b5cf6">text_extractor@v1</text>
    <text x="0" y="22" font-family="monospace" font-size="8" fill="#475569">ocr_extraction</text>
    <rect x="0" y="28" width="120" height="14" rx="3" fill="#f3e8ff"/>
    <text x="60" y="39" font-family="system-ui, sans-serif" font-size="8" fill="#7c3aed" text-anchor="middle">â†’ 8 text blocks</text>
  </g>

  <!-- Speaker Segments -->
  <path d="M 850 330 L 850 380 L 750 380 L 750 400" stroke="#94a3b8" stroke-width="2" fill="none" marker-end="url(#arrowGray)"/>
  <g filter="url(#shadow)">
    <rect x="680" y="405" width="140" height="90" rx="8" fill="white" stroke="#e2e8f0" stroke-width="2"/>
    <rect x="680" y="405" width="140" height="24" rx="8" fill="url(#tier2Grad)"/>
    <rect x="680" y="421" width="140" height="8" fill="url(#tier2Grad)"/>
    <text x="750" y="422" font-family="system-ui, sans-serif" font-size="10" font-weight="600" fill="white" text-anchor="middle">ğŸ—£ Speaker Segments</text>
  </g>
  <g transform="translate(690, 445)">
    <text x="0" y="10" font-family="monospace" font-size="8" fill="#8b5cf6">audio_extractor@v1</text>
    <text x="0" y="22" font-family="monospace" font-size="8" fill="#475569">diarization</text>
    <rect x="0" y="28" width="120" height="14" rx="3" fill="#f3e8ff"/>
    <text x="60" y="39" font-family="system-ui, sans-serif" font-size="8" fill="#7c3aed" text-anchor="middle">â†’ 3 speakers</text>
  </g>

  <!-- Transcript Chunks -->
  <path d="M 950 330 L 950 380 L 1050 380 L 1050 400" stroke="#94a3b8" stroke-width="2" fill="none" marker-end="url(#arrowGray)"/>
  <g filter="url(#shadow)">
    <rect x="980" y="405" width="140" height="90" rx="8" fill="white" stroke="#e2e8f0" stroke-width="2"/>
    <rect x="980" y="405" width="140" height="24" rx="8" fill="url(#tier2Grad)"/>
    <rect x="980" y="421" width="140" height="8" fill="url(#tier2Grad)"/>
    <text x="1050" y="422" font-family="system-ui, sans-serif" font-size="10" font-weight="600" fill="white" text-anchor="middle">ğŸ“„ Transcript Chunks</text>
  </g>
  <g transform="translate(990, 445)">
    <text x="0" y="10" font-family="monospace" font-size="8" fill="#8b5cf6">text_extractor@v1</text>
    <text x="0" y="22" font-family="monospace" font-size="8" fill="#475569">chunking</text>
    <rect x="0" y="28" width="120" height="14" rx="3" fill="#f3e8ff"/>
    <text x="60" y="39" font-family="system-ui, sans-serif" font-size="8" fill="#7c3aed" text-anchor="middle">â†’ 15 chunks</text>
  </g>

  <!-- Tier 3 Collections -->
  <!-- Face Embeddings -->
  <path d="M 120 495 L 120 570 L 180 570 L 180 590" stroke="#94a3b8" stroke-width="2" fill="none" marker-end="url(#arrowGray)"/>
  <g filter="url(#shadow)">
    <rect x="110" y="595" width="140" height="85" rx="8" fill="white" stroke="#e2e8f0" stroke-width="2"/>
    <rect x="110" y="595" width="140" height="24" rx="8" fill="url(#tier3Grad)"/>
    <rect x="110" y="611" width="140" height="8" fill="url(#tier3Grad)"/>
    <text x="180" y="612" font-family="system-ui, sans-serif" font-size="10" font-weight="600" fill="white" text-anchor="middle">ğŸ”¢ Face Embeddings</text>
  </g>
  <g transform="translate(120, 630)">
    <text x="0" y="10" font-family="monospace" font-size="8" fill="#ec4899">face_encoder@v1</text>
    <text x="0" y="22" font-family="monospace" font-size="8" fill="#475569">arcface</text>
    <rect x="0" y="28" width="120" height="14" rx="3" fill="#fce7f3"/>
    <text x="60" y="39" font-family="system-ui, sans-serif" font-size="8" fill="#db2777" text-anchor="middle">â†’ 12 embeddings</text>
  </g>

  <!-- Face Expressions -->
  <path d="M 180 495 L 180 570 L 330 570 L 330 590" stroke="#94a3b8" stroke-width="2" fill="none" marker-end="url(#arrowGray)"/>
  <g filter="url(#shadow)">
    <rect x="260" y="595" width="140" height="85" rx="8" fill="white" stroke="#e2e8f0" stroke-width="2"/>
    <rect x="260" y="595" width="140" height="24" rx="8" fill="url(#tier3Grad)"/>
    <rect x="260" y="611" width="140" height="8" fill="url(#tier3Grad)"/>
    <text x="330" y="612" font-family="system-ui, sans-serif" font-size="10" font-weight="600" fill="white" text-anchor="middle">ğŸ˜Š Face Expressions</text>
  </g>
  <g transform="translate(270, 630)">
    <text x="0" y="10" font-family="monospace" font-size="8" fill="#ec4899">expression_classifier@v1</text>
    <text x="0" y="22" font-family="monospace" font-size="8" fill="#475569">emotion_detection</text>
    <rect x="0" y="28" width="120" height="14" rx="3" fill="#fce7f3"/>
    <text x="60" y="39" font-family="system-ui, sans-serif" font-size="8" fill="#db2777" text-anchor="middle">â†’ 12 expressions</text>
  </g>

  <!-- Speaker ID -->
  <path d="M 750 495 L 750 570 L 750 590" stroke="#94a3b8" stroke-width="2" fill="none" marker-end="url(#arrowGray)"/>
  <g filter="url(#shadow)">
    <rect x="680" y="595" width="140" height="85" rx="8" fill="white" stroke="#e2e8f0" stroke-width="2"/>
    <rect x="680" y="595" width="140" height="24" rx="8" fill="url(#tier3Grad)"/>
    <rect x="680" y="611" width="140" height="8" fill="url(#tier3Grad)"/>
    <text x="750" y="612" font-family="system-ui, sans-serif" font-size="10" font-weight="600" fill="white" text-anchor="middle">ğŸ¤ Speaker ID</text>
  </g>
  <g transform="translate(690, 630)">
    <text x="0" y="10" font-family="monospace" font-size="8" fill="#ec4899">speaker_encoder@v1</text>
    <text x="0" y="22" font-family="monospace" font-size="8" fill="#475569">voice_embedding</text>
    <rect x="0" y="28" width="120" height="14" rx="3" fill="#fce7f3"/>
    <text x="60" y="39" font-family="system-ui, sans-serif" font-size="8" fill="#db2777" text-anchor="middle">â†’ 3 profiles</text>
  </g>

  <!-- Tier 4 Collections (Taxonomy Enrichment) -->
  <!-- Employee Match -->
  <path d="M 180 680 L 180 740 L 280 740 L 280 760" stroke="#94a3b8" stroke-width="2" fill="none" marker-end="url(#arrowGray)"/>
  <g filter="url(#shadow)">
    <rect x="200" y="765" width="160" height="85" rx="8" fill="white" stroke="#14b8a6" stroke-width="2"/>
    <rect x="200" y="765" width="160" height="24" rx="8" fill="url(#tier4Grad)"/>
    <rect x="200" y="781" width="160" height="8" fill="url(#tier4Grad)"/>
    <text x="280" y="782" font-family="system-ui, sans-serif" font-size="10" font-weight="600" fill="white" text-anchor="middle">ğŸ‘” Employee Match</text>
  </g>
  <g transform="translate(210, 800)">
    <text x="0" y="10" font-family="monospace" font-size="8" fill="#14b8a6">Taxonomy: employee_faces</text>
    <text x="0" y="22" font-family="monospace" font-size="8" fill="#475569">enrichment</text>
    <rect x="0" y="28" width="140" height="14" rx="3" fill="#f0fdfa"/>
    <text x="70" y="39" font-family="system-ui, sans-serif" font-size="8" fill="#0d9488" text-anchor="middle">â†’ 5 matched</text>
  </g>

  <!-- Executive Match -->
  <path d="M 750 680 L 750 740 L 750 760" stroke="#94a3b8" stroke-width="2" fill="none" marker-end="url(#arrowGray)"/>
  <g filter="url(#shadow)">
    <rect x="670" y="765" width="160" height="85" rx="8" fill="white" stroke="#14b8a6" stroke-width="2"/>
    <rect x="670" y="765" width="160" height="24" rx="8" fill="url(#tier4Grad)"/>
    <rect x="670" y="781" width="160" height="8" fill="url(#tier4Grad)"/>
    <text x="750" y="782" font-family="system-ui, sans-serif" font-size="10" font-weight="600" fill="white" text-anchor="middle">ğŸ¯ Executive Match</text>
  </g>
  <g transform="translate(680, 800)">
    <text x="0" y="10" font-family="monospace" font-size="8" fill="#14b8a6">Taxonomy: executive_voices</text>
    <text x="0" y="22" font-family="monospace" font-size="8" fill="#475569">enrichment</text>
    <rect x="0" y="28" width="140" height="14" rx="3" fill="#f0fdfa"/>
    <text x="70" y="39" font-family="system-ui, sans-serif" font-size="8" fill="#0d9488" text-anchor="middle">â†’ 1 matched</text>
  </g>

  <!-- Lineage Info Box -->
  <g filter="url(#shadow)">
    <rect x="900" y="595" width="250" height="130" rx="10" fill="white" stroke="#e2e8f0" stroke-width="2"/>
    <rect x="900" y="595" width="250" height="28" rx="10" fill="#334155"/>
    <rect x="900" y="613" width="250" height="10" fill="#334155"/>
    <text x="1025" y="615" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="white" text-anchor="middle">Document Lineage</text>
  </g>
  <g transform="translate(915, 635)">
    <text x="0" y="12" font-family="system-ui, sans-serif" font-size="9" fill="#475569">Each document retains:</text>
    <text x="0" y="30" font-family="monospace" font-size="8" fill="#6366f1">root_object_id</text>
    <text x="0" y="44" font-family="monospace" font-size="8" fill="#8b5cf6">source_collection_id</text>
    <text x="0" y="58" font-family="monospace" font-size="8" fill="#ec4899">source_document_id</text>
    <text x="0" y="72" font-family="monospace" font-size="8" fill="#14b8a6">lineage_path[]</text>
  </g>

  <!-- Legend -->
  <g transform="translate(100, 870)">
    <rect x="0" y="0" width="12" height="12" rx="2" fill="url(#objectGrad)"/>
    <text x="18" y="11" font-family="system-ui, sans-serif" font-size="10" fill="#475569">Source Object</text>
    
    <rect x="120" y="0" width="12" height="12" rx="2" fill="url(#tier1Grad)"/>
    <text x="138" y="11" font-family="system-ui, sans-serif" font-size="10" fill="#475569">Tier 1 (Bucket Source)</text>
    
    <rect x="280" y="0" width="12" height="12" rx="2" fill="url(#tier2Grad)"/>
    <text x="298" y="11" font-family="system-ui, sans-serif" font-size="10" fill="#475569">Tier 2 (Collection Source)</text>
    
    <rect x="470" y="0" width="12" height="12" rx="2" fill="url(#tier3Grad)"/>
    <text x="488" y="11" font-family="system-ui, sans-serif" font-size="10" fill="#475569">Tier 3</text>
    
    <rect x="560" y="0" width="12" height="12" rx="2" fill="url(#tier4Grad)"/>
    <text x="578" y="11" font-family="system-ui, sans-serif" font-size="10" fill="#475569">Tier 4 (Taxonomy Enrichment)</text>
    
    <line x1="780" y1="6" x2="820" y2="6" stroke="#94a3b8" stroke-width="2" marker-end="url(#arrowGray)"/>
    <text x="830" y="11" font-family="system-ui, sans-serif" font-size="10" fill="#475569">Data flow</text>
    
    <line x1="920" y1="6" x2="960" y2="6" stroke="#e2e8f0" stroke-width="1" stroke-dasharray="4,4"/>
    <text x="970" y="11" font-family="system-ui, sans-serif" font-size="10" fill="#475569">Tier boundary</text>
  </g>

</svg>