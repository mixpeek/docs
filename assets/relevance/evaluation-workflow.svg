<svg viewBox="0 0 1200 440" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <linearGradient id="datasetGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#6366f1;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#4f46e5;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="executeGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#f97316;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#ea580c;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="compareGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#8b5cf6;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#7c3aed;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="metricsGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#10b981;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#059669;stop-opacity:1" />
    </linearGradient>
    
    <marker id="arrowEW" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#94a3b8"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect width="1200" height="440" fill="none"/>

  <!-- Title -->
  <text x="600" y="40" font-family="system-ui, -apple-system, sans-serif" font-size="24" font-weight="600" fill="#f1f5f9" text-anchor="middle">Evaluation Workflow</text>
  <text x="600" y="65" font-family="system-ui, sans-serif" font-size="13" fill="#94a3b8" text-anchor="middle">Measure retriever quality with ground truth datasets and standard IR metrics</text>

  <!-- Step 1: Ground Truth Dataset -->
  <g>
    <rect x="40" y="100" width="250" height="220" rx="12" fill="white" stroke="#334155" stroke-width="2"/>
    <rect x="40" y="100" width="250" height="32" rx="12" fill="url(#datasetGrad)"/>
    <rect x="40" y="120" width="250" height="12" fill="url(#datasetGrad)"/>
    <text x="165" y="123" font-family="system-ui, sans-serif" font-size="13" font-weight="600" fill="white" text-anchor="middle">1. Ground Truth Dataset</text>
  </g>

  <!-- Dataset entries -->
  <g transform="translate(56, 145)">
    <rect x="0" y="0" width="218" height="44" rx="6" fill="#eef2ff"/>
    <text x="10" y="16" font-family="system-ui, sans-serif" font-size="10" font-weight="600" fill="#4338ca">Query: "wireless earbuds"</text>
    <text x="10" y="34" font-family="system-ui, sans-serif" font-size="10" fill="#475569">Relevant: doc_a1, doc_a2, doc_a3</text>
  </g>
  <g transform="translate(56, 197)">
    <rect x="0" y="0" width="218" height="44" rx="6" fill="#eef2ff"/>
    <text x="10" y="16" font-family="system-ui, sans-serif" font-size="10" font-weight="600" fill="#4338ca">Query: "noise canceling"</text>
    <text x="10" y="34" font-family="system-ui, sans-serif" font-size="10" fill="#475569">Relevant: doc_b1, doc_b4, doc_b7</text>
  </g>
  <g transform="translate(56, 249)">
    <rect x="0" y="0" width="218" height="44" rx="6" fill="#eef2ff"/>
    <text x="10" y="16" font-family="system-ui, sans-serif" font-size="10" font-weight="600" fill="#4338ca">Query: "running headphones"</text>
    <text x="10" y="34" font-family="system-ui, sans-serif" font-size="10" fill="#475569">Relevant: doc_c2, doc_c5</text>
  </g>

  <text x="165" y="310" font-family="system-ui, sans-serif" font-size="10" fill="#94a3b8" text-anchor="middle">50+ queries recommended</text>

  <!-- Arrow 1→2 -->
  <line x1="290" y1="210" x2="340" y2="210" stroke="#94a3b8" stroke-width="2" marker-end="url(#arrowEW)"/>

  <!-- Step 2: Execute Retriever -->
  <g>
    <rect x="350" y="100" width="250" height="220" rx="12" fill="white" stroke="#334155" stroke-width="2"/>
    <rect x="350" y="100" width="250" height="32" rx="12" fill="url(#executeGrad)"/>
    <rect x="350" y="120" width="250" height="12" fill="url(#executeGrad)"/>
    <text x="475" y="123" font-family="system-ui, sans-serif" font-size="13" font-weight="600" fill="white" text-anchor="middle">2. Execute Retriever</text>
  </g>

  <!-- Execution items -->
  <g transform="translate(366, 145)">
    <rect x="0" y="0" width="218" height="44" rx="6" fill="#fff7ed"/>
    <text x="10" y="16" font-family="system-ui, sans-serif" font-size="10" font-weight="600" fill="#c2410c">Results: "wireless earbuds"</text>
    <text x="10" y="34" font-family="system-ui, sans-serif" font-size="10" fill="#475569">doc_a1, doc_x9, doc_a3, doc_a2...</text>
  </g>
  <g transform="translate(366, 197)">
    <rect x="0" y="0" width="218" height="44" rx="6" fill="#fff7ed"/>
    <text x="10" y="16" font-family="system-ui, sans-serif" font-size="10" font-weight="600" fill="#c2410c">Results: "noise canceling"</text>
    <text x="10" y="34" font-family="system-ui, sans-serif" font-size="10" fill="#475569">doc_b1, doc_b4, doc_y2, doc_b7...</text>
  </g>
  <g transform="translate(366, 249)">
    <rect x="0" y="0" width="218" height="44" rx="6" fill="#fff7ed"/>
    <text x="10" y="16" font-family="system-ui, sans-serif" font-size="10" font-weight="600" fill="#c2410c">Results: "running headphones"</text>
    <text x="10" y="34" font-family="system-ui, sans-serif" font-size="10" fill="#475569">doc_z3, doc_c2, doc_c5, doc_w1...</text>
  </g>

  <text x="475" y="310" font-family="system-ui, sans-serif" font-size="10" fill="#94a3b8" text-anchor="middle">Each query executed at k=1,5,10,20</text>

  <!-- Arrow 2→3 -->
  <line x1="600" y1="210" x2="650" y2="210" stroke="#94a3b8" stroke-width="2" marker-end="url(#arrowEW)"/>

  <!-- Step 3: Compare -->
  <g>
    <rect x="660" y="100" width="220" height="220" rx="12" fill="white" stroke="#334155" stroke-width="2"/>
    <rect x="660" y="100" width="220" height="32" rx="12" fill="url(#compareGrad)"/>
    <rect x="660" y="120" width="220" height="12" fill="url(#compareGrad)"/>
    <text x="770" y="123" font-family="system-ui, sans-serif" font-size="13" font-weight="600" fill="white" text-anchor="middle">3. Compare</text>
  </g>

  <text x="770" y="155" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="#f1f5f9" text-anchor="middle">Ground Truth vs Retrieved</text>

  <g transform="translate(676, 168)">
    <rect x="0" y="0" width="188" height="20" rx="4" fill="#ecfdf5"/>
    <text x="10" y="14" font-family="system-ui, sans-serif" font-size="10" fill="#047857">doc_a1</text>
    <text x="150" y="14" font-family="system-ui, sans-serif" font-size="10" fill="#047857">match</text>
  </g>
  <g transform="translate(676, 192)">
    <rect x="0" y="0" width="188" height="20" rx="4" fill="#fef2f2"/>
    <text x="10" y="14" font-family="system-ui, sans-serif" font-size="10" fill="#dc2626">doc_x9</text>
    <text x="150" y="14" font-family="system-ui, sans-serif" font-size="10" fill="#dc2626">miss</text>
  </g>
  <g transform="translate(676, 216)">
    <rect x="0" y="0" width="188" height="20" rx="4" fill="#ecfdf5"/>
    <text x="10" y="14" font-family="system-ui, sans-serif" font-size="10" fill="#047857">doc_a3</text>
    <text x="150" y="14" font-family="system-ui, sans-serif" font-size="10" fill="#047857">match</text>
  </g>
  <g transform="translate(676, 240)">
    <rect x="0" y="0" width="188" height="20" rx="4" fill="#ecfdf5"/>
    <text x="10" y="14" font-family="system-ui, sans-serif" font-size="10" fill="#047857">doc_a2</text>
    <text x="150" y="14" font-family="system-ui, sans-serif" font-size="10" fill="#047857">match</text>
  </g>

  <text x="770" y="286" font-family="system-ui, sans-serif" font-size="11" fill="#475569" text-anchor="middle">3/4 relevant in top 4</text>
  <text x="770" y="310" font-family="system-ui, sans-serif" font-size="10" fill="#94a3b8" text-anchor="middle">Position-aware scoring</text>

  <!-- Arrow 3→4 -->
  <line x1="880" y1="210" x2="930" y2="210" stroke="#94a3b8" stroke-width="2" marker-end="url(#arrowEW)"/>

  <!-- Step 4: Metrics -->
  <g>
    <rect x="940" y="100" width="220" height="220" rx="12" fill="white" stroke="#334155" stroke-width="2"/>
    <rect x="940" y="100" width="220" height="32" rx="12" fill="url(#metricsGrad)"/>
    <rect x="940" y="120" width="220" height="12" fill="url(#metricsGrad)"/>
    <text x="1050" y="123" font-family="system-ui, sans-serif" font-size="13" font-weight="600" fill="white" text-anchor="middle">4. Metrics</text>
  </g>

  <g transform="translate(956, 148)">
    <rect x="0" y="0" width="188" height="24" rx="4" fill="#ecfdf5"/>
    <text x="10" y="16" font-family="system-ui, sans-serif" font-size="11" fill="#047857">NDCG@10</text>
    <text x="150" y="16" font-family="system-ui, sans-serif" font-size="12" font-weight="600" fill="#047857">0.89</text>
  </g>
  <g transform="translate(956, 178)">
    <rect x="0" y="0" width="188" height="24" rx="4" fill="#ecfdf5"/>
    <text x="10" y="16" font-family="system-ui, sans-serif" font-size="11" fill="#047857">Precision@10</text>
    <text x="150" y="16" font-family="system-ui, sans-serif" font-size="12" font-weight="600" fill="#047857">0.75</text>
  </g>
  <g transform="translate(956, 208)">
    <rect x="0" y="0" width="188" height="24" rx="4" fill="#ecfdf5"/>
    <text x="10" y="16" font-family="system-ui, sans-serif" font-size="11" fill="#047857">Recall@10</text>
    <text x="150" y="16" font-family="system-ui, sans-serif" font-size="12" font-weight="600" fill="#047857">0.82</text>
  </g>
  <g transform="translate(956, 238)">
    <rect x="0" y="0" width="188" height="24" rx="4" fill="#ecfdf5"/>
    <text x="10" y="16" font-family="system-ui, sans-serif" font-size="11" fill="#047857">MAP</text>
    <text x="150" y="16" font-family="system-ui, sans-serif" font-size="12" font-weight="600" fill="#047857">0.71</text>
  </g>
  <g transform="translate(956, 268)">
    <rect x="0" y="0" width="188" height="24" rx="4" fill="#ecfdf5"/>
    <text x="10" y="16" font-family="system-ui, sans-serif" font-size="11" fill="#047857">MRR</text>
    <text x="150" y="16" font-family="system-ui, sans-serif" font-size="12" font-weight="600" fill="#047857">0.93</text>
  </g>
  <g transform="translate(956, 298)">
    <rect x="0" y="0" width="188" height="24" rx="4" fill="#ecfdf5"/>
    <text x="10" y="16" font-family="system-ui, sans-serif" font-size="11" fill="#047857">F1@10</text>
    <text x="150" y="16" font-family="system-ui, sans-serif" font-size="12" font-weight="600" fill="#047857">0.78</text>
  </g>

  <!-- Bottom guidance -->
  <g transform="translate(40, 370)">
    <rect x="0" y="0" width="1120" height="50" rx="10" fill="white" stroke="#334155" stroke-width="1"/>
    <text x="30" y="20" font-family="system-ui, sans-serif" font-size="12" font-weight="600" fill="#f1f5f9">Interpret:</text>
    <text x="100" y="20" font-family="system-ui, sans-serif" font-size="11" fill="#475569">NDCG@10 = 0.89 means your top-10 ranking captures 89% of an ideal ordering.</text>
    <text x="100" y="38" font-family="system-ui, sans-serif" font-size="11" fill="#475569">MRR = 0.93 means users typically find their first relevant result at position 1-2.</text>
  </g>
</svg>