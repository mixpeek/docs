<svg viewBox="0 0 1200 600" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <linearGradient id="queryGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#6366f1;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#4f46e5;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="searchGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#f97316;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#ea580c;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="filterGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#10b981;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#059669;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="rankGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#8b5cf6;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#7c3aed;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="enrichGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#ec4899;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#db2777;stop-opacity:1" />
    </linearGradient>
    
  </defs>

  <!-- Background -->
  <rect width="1200" height="600" fill="none"/>
  
  <!-- Title -->
  <text x="600" y="40" font-family="system-ui, -apple-system, sans-serif" font-size="24" font-weight="600" fill="#f1f5f9" text-anchor="middle">Retrieval Reassembly</text>
  <text x="600" y="65" font-family="system-ui, sans-serif" font-size="13" fill="#94a3b8" text-anchor="middle">Chaining search stages to recompose results</text>

  <!-- Level Labels on left side -->
  <text x="20" y="130" font-family="system-ui, sans-serif" font-size="12" fill="#94a3b8" font-weight="500">Query</text>
  <text x="20" y="230" font-family="system-ui, sans-serif" font-size="12" fill="#94a3b8" font-weight="500">Vector Search</text>
  <text x="20" y="330" font-family="system-ui, sans-serif" font-size="12" fill="#94a3b8" font-weight="500">Entity Filter</text>
  <text x="20" y="430" font-family="system-ui, sans-serif" font-size="12" fill="#94a3b8" font-weight="500">Similarity Rank</text>
  <text x="20" y="530" font-family="system-ui, sans-serif" font-size="12" fill="#94a3b8" font-weight="500">Enrich</text>

  <!-- Level 1: Query (1 item - wide) -->
  <g>
    <rect x="200" y="95" width="800" height="60" rx="10" fill="white" stroke="#334155" stroke-width="2"/>
    <rect x="200" y="95" width="800" height="60" rx="10" fill="url(#queryGrad)"/>
    <text x="600" y="132" font-family="system-ui, sans-serif" font-size="16" font-weight="600" fill="white" text-anchor="middle">"product demo with Sarah"</text>
  </g>
  
  <!-- Connector lines from Query to Search Results -->
  <line x1="350" y1="155" x2="250" y2="195" stroke="#94a3b8" stroke-width="2"/>
  <line x1="480" y1="155" x2="420" y2="195" stroke="#94a3b8" stroke-width="2"/>
  <line x1="600" y1="155" x2="590" y2="195" stroke="#94a3b8" stroke-width="2"/>
  <line x1="720" y1="155" x2="760" y2="195" stroke="#94a3b8" stroke-width="2"/>
  <line x1="850" y1="155" x2="930" y2="195" stroke="#94a3b8" stroke-width="2"/>

  <!-- Level 2: Vector Search Results (many items) -->
  <g>
    <rect x="200" y="195" width="100" height="50" rx="8" fill="white" stroke="#334155" stroke-width="2"/>
    <rect x="200" y="195" width="100" height="50" rx="8" fill="url(#searchGrad)"/>
    <text x="250" y="220" font-family="system-ui, sans-serif" font-size="10" font-weight="600" fill="white" text-anchor="middle">Segment 12</text>
    <text x="250" y="233" font-family="system-ui, sans-serif" font-size="9" fill="white" fill-opacity="0.8" text-anchor="middle">0.94</text>
  </g>
  <g>
    <rect x="310" y="195" width="100" height="50" rx="8" fill="white" stroke="#334155" stroke-width="2"/>
    <rect x="310" y="195" width="100" height="50" rx="8" fill="url(#searchGrad)"/>
    <text x="360" y="220" font-family="system-ui, sans-serif" font-size="10" font-weight="600" fill="white" text-anchor="middle">Segment 47</text>
    <text x="360" y="233" font-family="system-ui, sans-serif" font-size="9" fill="white" fill-opacity="0.8" text-anchor="middle">0.91</text>
  </g>
  <g>
    <rect x="420" y="195" width="100" height="50" rx="8" fill="white" stroke="#334155" stroke-width="2"/>
    <rect x="420" y="195" width="100" height="50" rx="8" fill="url(#searchGrad)"/>
    <text x="470" y="220" font-family="system-ui, sans-serif" font-size="10" font-weight="600" fill="white" text-anchor="middle">Segment 8</text>
    <text x="470" y="233" font-family="system-ui, sans-serif" font-size="9" fill="white" fill-opacity="0.8" text-anchor="middle">0.89</text>
  </g>
  <g>
    <rect x="530" y="195" width="100" height="50" rx="8" fill="white" stroke="#334155" stroke-width="2"/>
    <rect x="530" y="195" width="100" height="50" rx="8" fill="url(#searchGrad)"/>
    <text x="580" y="220" font-family="system-ui, sans-serif" font-size="10" font-weight="600" fill="white" text-anchor="middle">Segment 23</text>
    <text x="580" y="233" font-family="system-ui, sans-serif" font-size="9" fill="white" fill-opacity="0.8" text-anchor="middle">0.87</text>
  </g>
  <g>
    <rect x="640" y="195" width="100" height="50" rx="8" fill="white" stroke="#334155" stroke-width="2"/>
    <rect x="640" y="195" width="100" height="50" rx="8" fill="url(#searchGrad)"/>
    <text x="690" y="220" font-family="system-ui, sans-serif" font-size="10" font-weight="600" fill="white" text-anchor="middle">Segment 3</text>
    <text x="690" y="233" font-family="system-ui, sans-serif" font-size="9" fill="white" fill-opacity="0.8" text-anchor="middle">0.85</text>
  </g>
  <g>
    <rect x="750" y="195" width="100" height="50" rx="8" fill="white" stroke="#334155" stroke-width="2"/>
    <rect x="750" y="195" width="100" height="50" rx="8" fill="url(#searchGrad)"/>
    <text x="800" y="220" font-family="system-ui, sans-serif" font-size="10" font-weight="600" fill="white" text-anchor="middle">Segment 91</text>
    <text x="800" y="233" font-family="system-ui, sans-serif" font-size="9" fill="white" fill-opacity="0.8" text-anchor="middle">0.82</text>
  </g>
  <g>
    <rect x="860" y="195" width="100" height="50" rx="8" fill="white" stroke="#334155" stroke-width="2"/>
    <rect x="860" y="195" width="100" height="50" rx="8" fill="url(#searchGrad)"/>
    <text x="910" y="220" font-family="system-ui, sans-serif" font-size="10" font-weight="600" fill="white" text-anchor="middle">Segment 56</text>
    <text x="910" y="233" font-family="system-ui, sans-serif" font-size="9" fill="white" fill-opacity="0.8" text-anchor="middle">0.79</text>
  </g>

  <!-- Connector lines from Search to Filter (some filtered out) -->
  <line x1="250" y1="245" x2="300" y2="295" stroke="#94a3b8" stroke-width="2"/>
  <line x1="470" y1="245" x2="470" y2="295" stroke="#94a3b8" stroke-width="2"/>
  <line x1="580" y1="245" x2="640" y2="295" stroke="#94a3b8" stroke-width="2"/>
  <line x1="800" y1="245" x2="810" y2="295" stroke="#94a3b8" stroke-width="2"/>
  
  <!-- Filtered out indicators -->
  <line x1="360" y1="245" x2="360" y2="270" stroke="#94a3b8" stroke-width="1.5" stroke-dasharray="4,3" opacity="0.4"/>
  <line x1="690" y1="245" x2="690" y2="270" stroke="#94a3b8" stroke-width="1.5" stroke-dasharray="4,3" opacity="0.4"/>
  <line x1="910" y1="245" x2="910" y2="270" stroke="#94a3b8" stroke-width="1.5" stroke-dasharray="4,3" opacity="0.4"/>
  
  <text x="360" y="283" font-family="system-ui, sans-serif" font-size="9" fill="#94a3b8" text-anchor="middle">no Sarah</text>
  <text x="690" y="283" font-family="system-ui, sans-serif" font-size="9" fill="#94a3b8" text-anchor="middle">no Sarah</text>
  <text x="910" y="283" font-family="system-ui, sans-serif" font-size="9" fill="#94a3b8" text-anchor="middle">no Sarah</text>

  <!-- Level 3: Entity Filter Results (fewer items) -->
  <g>
    <rect x="250" y="295" width="100" height="50" rx="8" fill="white" stroke="#334155" stroke-width="2"/>
    <rect x="250" y="295" width="100" height="50" rx="8" fill="url(#filterGrad)"/>
    <text x="300" y="320" font-family="system-ui, sans-serif" font-size="10" font-weight="600" fill="white" text-anchor="middle">Segment 12</text>
    <text x="300" y="333" font-family="system-ui, sans-serif" font-size="9" fill="white" fill-opacity="0.8" text-anchor="middle">Sarah ✓</text>
  </g>
  <g>
    <rect x="420" y="295" width="100" height="50" rx="8" fill="white" stroke="#334155" stroke-width="2"/>
    <rect x="420" y="295" width="100" height="50" rx="8" fill="url(#filterGrad)"/>
    <text x="470" y="320" font-family="system-ui, sans-serif" font-size="10" font-weight="600" fill="white" text-anchor="middle">Segment 8</text>
    <text x="470" y="333" font-family="system-ui, sans-serif" font-size="9" fill="white" fill-opacity="0.8" text-anchor="middle">Sarah ✓</text>
  </g>
  <g>
    <rect x="590" y="295" width="100" height="50" rx="8" fill="white" stroke="#334155" stroke-width="2"/>
    <rect x="590" y="295" width="100" height="50" rx="8" fill="url(#filterGrad)"/>
    <text x="640" y="320" font-family="system-ui, sans-serif" font-size="10" font-weight="600" fill="white" text-anchor="middle">Segment 23</text>
    <text x="640" y="333" font-family="system-ui, sans-serif" font-size="9" fill="white" fill-opacity="0.8" text-anchor="middle">Sarah ✓</text>
  </g>
  <g>
    <rect x="760" y="295" width="100" height="50" rx="8" fill="white" stroke="#334155" stroke-width="2"/>
    <rect x="760" y="295" width="100" height="50" rx="8" fill="url(#filterGrad)"/>
    <text x="810" y="320" font-family="system-ui, sans-serif" font-size="10" font-weight="600" fill="white" text-anchor="middle">Segment 91</text>
    <text x="810" y="333" font-family="system-ui, sans-serif" font-size="9" fill="white" fill-opacity="0.8" text-anchor="middle">Sarah ✓</text>
  </g>

  <!-- Connector lines from Filter to Rank -->
  <line x1="300" y1="345" x2="360" y2="395" stroke="#94a3b8" stroke-width="2"/>
  <line x1="470" y1="345" x2="500" y2="395" stroke="#94a3b8" stroke-width="2"/>
  <line x1="640" y1="345" x2="640" y2="395" stroke="#94a3b8" stroke-width="2"/>
  <line x1="810" y1="345" x2="780" y2="395" stroke="#94a3b8" stroke-width="2"/>

  <!-- Level 4: Similarity Rank (reordered, fewer) -->
  <g>
    <rect x="310" y="395" width="100" height="50" rx="8" fill="white" stroke="#334155" stroke-width="2"/>
    <rect x="310" y="395" width="100" height="50" rx="8" fill="url(#rankGrad)"/>
    <text x="360" y="420" font-family="system-ui, sans-serif" font-size="10" font-weight="600" fill="white" text-anchor="middle">Segment 8</text>
    <text x="360" y="433" font-family="system-ui, sans-serif" font-size="9" fill="white" fill-opacity="0.8" text-anchor="middle">#1 Product</text>
  </g>
  <g>
    <rect x="450" y="395" width="100" height="50" rx="8" fill="white" stroke="#334155" stroke-width="2"/>
    <rect x="450" y="395" width="100" height="50" rx="8" fill="url(#rankGrad)"/>
    <text x="500" y="420" font-family="system-ui, sans-serif" font-size="10" font-weight="600" fill="white" text-anchor="middle">Segment 12</text>
    <text x="500" y="433" font-family="system-ui, sans-serif" font-size="9" fill="white" fill-opacity="0.8" text-anchor="middle">#2 Product</text>
  </g>
  <g>
    <rect x="590" y="395" width="100" height="50" rx="8" fill="white" stroke="#334155" stroke-width="2"/>
    <rect x="590" y="395" width="100" height="50" rx="8" fill="url(#rankGrad)"/>
    <text x="640" y="420" font-family="system-ui, sans-serif" font-size="10" font-weight="600" fill="white" text-anchor="middle">Segment 91</text>
    <text x="640" y="433" font-family="system-ui, sans-serif" font-size="9" fill="white" fill-opacity="0.8" text-anchor="middle">#3 Product</text>
  </g>
  <g>
    <rect x="730" y="395" width="100" height="50" rx="8" fill="white" stroke="#334155" stroke-width="2"/>
    <rect x="730" y="395" width="100" height="50" rx="8" fill="url(#rankGrad)"/>
    <text x="780" y="420" font-family="system-ui, sans-serif" font-size="10" font-weight="600" fill="white" text-anchor="middle">Segment 23</text>
    <text x="780" y="433" font-family="system-ui, sans-serif" font-size="9" fill="white" fill-opacity="0.8" text-anchor="middle">#4 Product</text>
  </g>

  <!-- Connector lines from Rank to Enrich -->
  <line x1="360" y1="445" x2="420" y2="495" stroke="#94a3b8" stroke-width="2"/>
  <line x1="500" y1="445" x2="560" y2="495" stroke="#94a3b8" stroke-width="2"/>
  <line x1="640" y1="445" x2="700" y2="495" stroke="#94a3b8" stroke-width="2"/>

  <!-- Level 5: Enriched Results (final) -->
  <g>
    <rect x="350" y="495" width="140" height="60" rx="8" fill="white" stroke="#334155" stroke-width="2"/>
    <rect x="350" y="495" width="140" height="60" rx="8" fill="url(#enrichGrad)"/>
    <text x="420" y="520" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="white" text-anchor="middle">Result 1</text>
    <text x="420" y="535" font-family="system-ui, sans-serif" font-size="9" fill="white" fill-opacity="0.9" text-anchor="middle">00:02:34 - 00:03:12</text>
    <text x="420" y="548" font-family="system-ui, sans-serif" font-size="8" fill="white" fill-opacity="0.7" text-anchor="middle">+ transcript + context</text>
  </g>
  <g>
    <rect x="530" y="495" width="140" height="60" rx="8" fill="white" stroke="#334155" stroke-width="2"/>
    <rect x="530" y="495" width="140" height="60" rx="8" fill="url(#enrichGrad)"/>
    <text x="600" y="520" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="white" text-anchor="middle">Result 2</text>
    <text x="600" y="535" font-family="system-ui, sans-serif" font-size="9" fill="white" fill-opacity="0.9" text-anchor="middle">00:08:15 - 00:09:01</text>
    <text x="600" y="548" font-family="system-ui, sans-serif" font-size="8" fill="white" fill-opacity="0.7" text-anchor="middle">+ transcript + context</text>
  </g>
  <g>
    <rect x="710" y="495" width="140" height="60" rx="8" fill="white" stroke="#334155" stroke-width="2"/>
    <rect x="710" y="495" width="140" height="60" rx="8" fill="url(#enrichGrad)"/>
    <text x="780" y="520" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="white" text-anchor="middle">Result 3</text>
    <text x="780" y="535" font-family="system-ui, sans-serif" font-size="9" fill="white" fill-opacity="0.9" text-anchor="middle">00:14:22 - 00:15:08</text>
    <text x="780" y="548" font-family="system-ui, sans-serif" font-size="8" fill="white" fill-opacity="0.7" text-anchor="middle">+ transcript + context</text>
  </g>

  <!-- Legend -->
  <g transform="translate(200, 575)">
    <rect width="12" height="12" rx="2" fill="url(#queryGrad)"/>
    <text x="20" y="11" font-family="system-ui, sans-serif" font-size="11" fill="#475569">Query Input</text>
    
    <rect x="110" width="12" height="12" rx="2" fill="url(#searchGrad)"/>
    <text x="130" y="11" font-family="system-ui, sans-serif" font-size="11" fill="#475569">Vector Search</text>
    
    <rect x="240" width="12" height="12" rx="2" fill="url(#filterGrad)"/>
    <text x="260" y="11" font-family="system-ui, sans-serif" font-size="11" fill="#475569">Entity Filter</text>
    
    <rect x="360" width="12" height="12" rx="2" fill="url(#rankGrad)"/>
    <text x="380" y="11" font-family="system-ui, sans-serif" font-size="11" fill="#475569">Similarity Rank</text>
    
    <rect x="500" width="12" height="12" rx="2" fill="url(#enrichGrad)"/>
    <text x="520" y="11" font-family="system-ui, sans-serif" font-size="11" fill="#475569">Enriched Results</text>
  </g>

</svg>
