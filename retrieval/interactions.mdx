---
title: "Interactions"
description: "Capture user feedback to improve retrieval"
---

Interactions record how users engage with retriever results. Store clicks, long views, purchases, skips, and other signals to power learning-to-rank, collaborative filtering, or analytics.

## Interaction Model

```json
{
  "interaction_id": "int_abc123",
  "feature_id": "doc_xyz789",
  "interaction_type": ["click", "long_view"],
  "position": 2,
  "metadata": {
    "duration_ms": 12000,
    "device": "mobile"
  },
  "user_id": "user_456",
  "session_id": "sess_xyz789",
  "created_at": "2025-10-28T10:15:23Z"
}
```

- `feature_id` should match a `document_id` returned by a retriever execution.
- `interaction_type` accepts multiple labels per event (e.g., `["click", "long_view"]`).
- `position` is the 0-based position in the result set.
- `metadata` stores arbitrary context.

## Capture an Interaction

```bash
curl -sS -X POST "$MP_API_URL/v1/retrievers/interactions" \
  -H "Authorization: Bearer $MP_API_KEY" \
  -H "X-Namespace: $MP_NAMESPACE" \
  -H "Content-Type: application/json" \
  -d '{
    "feature_id": "doc_xyz789",
    "interaction_type": ["click"],
    "position": 3,
    "metadata": {
      "duration_ms": 4500,
      "query": "wireless earbuds"
    },
    "user_id": "user_123",
    "session_id": "sess_456"
  }'
```

## Supported Interaction Types

| Type | Signal | Description |
|------|--------|-------------|
| `click` | Positive (moderate) | User clicked the result |
| `view` | Neutral | Result was viewed |
| `long_view` | Positive (engagement) | User spent significant time on the result |
| `positive_feedback` | Positive | Thumbs up / helpful vote |
| `negative_feedback` | Negative | Thumbs down / not helpful |
| `add_to_cart`, `purchase`, `wishlist` | Positive | Conversion-focused events |
| `skip`, `return_to_results` | Negative | User ignored or bounced |
| `query_refinement`, `zero_results` | Query signal | User refined query or saw no results |

You can also define custom interaction types. Keep naming consistent to unlock downstream analytics.

## Query Interactions

```bash
curl -sS -X GET "$MP_API_URL/v1/retrievers/interactions?feature_id=doc_xyz789&limit=20" \
  -H "Authorization: Bearer $MP_API_KEY" \
  -H "X-Namespace: $MP_NAMESPACE"
```

Use filters to slice by `interaction_type`, `user_id`, or `session_id`. For bulk exports, paginate using `page` and `page_size`.

## Delete an Interaction

```bash
curl -sS -X DELETE "$MP_API_URL/v1/retrievers/interactions/<interaction_id>" \
  -H "Authorization: Bearer $MP_API_KEY" \
  -H "X-Namespace: $MP_NAMESPACE"
```

Supports GDPR-style removal or deduplication workflows.

## Integrating with Retrievers

Use interactions to:

- **Exclude consumed results**: pass a filter referencing previous `feature_id`s.
- **Boost popular content**: feed click/conversion signals into reranking or score fusion stages.
- **Personalize**: build user preference vectors externally and inject them via retriever inputs or joins.
- **Measure quality**: correlate `interaction_type` frequency with retriever executions using execution IDs.

## Best Practices

1. **Capture context** – record `query_text`, device, or surface in the `metadata` field.
2. **Store position** – position data is critical for correcting rank bias in learning-to-rank.
3. **Batch or stream** – interactions can be sent synchronously or aggregated and submitted in batches.
4. **Respect privacy** – hash or tokenize `user_id` if you need anonymization; honour deletion requests via the DELETE endpoint.
5. **Analyze regularly** – pipe interactions into your analytics warehouse to spot relevance regressions or new personalization opportunities.

The Interactions API gives you a canonical stream of user feedback—perfect for closing the loop between retrieval quality and real-world behavior.
