---
title: "Retrievers"
description: "Configure and execute staged retrieval pipelines over your collections"
---

<Note>
  Retrievers are schema‑validated, multi‑stage search pipelines. They combine vector search, metadata filters, grouping, sorting, and optional post‑processing to return ranked results from one or more collections.
</Note>

## Overview

<CardGroup cols={2}>
  <Card title="Pipelines" icon="layer-group">
    Compose ordered stages (KNN, hybrid, filters, reranking, generation)
  </Card>
  
  <Card title="Schema" icon="brackets-curly">
    Define an input schema for query‑time <code>inputs</code>
  </Card>
  
  <Card title="Collections" icon="database">
    Target one or more collections for search
  </Card>
  
  <Card title="Execution" icon="play">
    Single <code>execute</code> endpoint with filters, sorts, grouping, selection, pagination
  </Card>
</CardGroup>

## Capabilities

<CardGroup cols={3}>
  <Card title="Vector & Hybrid" icon="magnifying-glass">
    KNN over specific indexes; hybrid fusion across multiple vectors
  </Card>
  
  <Card title="Filters & Logic" icon="filter">
    AND/OR/NOT with typed operators and case sensitivity controls
  </Card>
  
  <Card title="Sorting & Paging" icon="sort">
    Sort by score or fields; stable <code>limit</code>/<code>offset</code>
  </Card>
</CardGroup>

<CardGroup cols={3}>
  <Card title="Grouping & Selection" icon="object-group">
    Group by a field; return only requested fields via <code>select</code>
  </Card>
  
  <Card title="Presigned URLs" icon="link">
    Optional asset URLs with <code>return_urls=true</code>
  </Card>
  
  <Card title="Introspection" icon="list">
    List stages and describe features to understand searchable fields
  </Card>
</CardGroup>

## Create a retriever

- **API**: Create Retriever
- **Method**: POST
- **Path**: `/v1/retrievers`
- **Reference**: [API Reference](/api-reference/retrievers/create-retriever)

```bash
curl -X POST https://api.mixpeek.com/v1/retrievers \
  -H "Authorization: Bearer $API_KEY" \
  -H "X-Namespace: ns_123" \
  -H "Content-Type: application/json" \
  -d '{
    "retriever_name": "products_semantic_v1",
    "description": "Semantic search over product catalog",
    "collection_ids": ["col_products_v1"],
    "input_schema": {"properties": {"query_text": {"type": "text"}}},
    "stages": [
      {"stage_name": "knn_search", "version": "1.0.0", "parameters": {"k": 50, "vector_field": "features.text_embedding"}}
    ]
  }'
```

## Execute a retriever

- **API**: Execute Retriever
- **Method**: POST
- **Path**: `/v1/retrievers/{retriever_identifier}/execute`
- **Reference**: [API Reference](/api-reference/retrievers/execute-retriever)

```bash
curl -X POST https://api.mixpeek.com/v1/retrievers/RET_ID/execute \
  -H "Authorization: Bearer $API_KEY" \
  -H "X-Namespace: ns_123" \
  -H "Content-Type: application/json" \
  -d '{
    "inputs": {"query_text": "red running shoes"},
    "filters": {"AND": [{"field": "metadata.category", "operator": "eq", "value": "footwear"}]},
    "sorts": [{"field": "score", "direction": "desc"}],
    "group_by": {"field": "metadata.brand", "max_features": 3},
    "select": ["document_id", "metadata.brand", "title"],
    "limit": 10,
    "offset": 0,
    "return_urls": true
  }'
```

## How it works

<Frame>
  ```mermaid
  graph TD
    Q[Query Inputs] --> R[Retriever]
    R --> S1[Stage 1]
    S1 --> S2[Stage 2]
    S2 --> S3[Stage 3]
    S3 --> OUT[Results]
  ```
</Frame>

<Steps>
  <Step title="Inputs">
    Validated against the retriever <code>input_schema</code>
  </Step>
  <Step title="Stage execution">
    Each stage refines candidates; hybrid and filters can combine modalities and metadata
  </Step>
  <Step title="Response shaping">
    Apply optional grouping, sorting, pagination, and <code>select</code>
  </Step>
</Steps>

<Tip>
  Enable <code>return_urls=true</code> to include presigned URLs for assets in results.
</Tip>

## Inputs and filters

<Tabs>
  <Tab title="Filters payload">
    ```json
    {
      "AND": [
        {"field": "metadata.category", "operator": "eq", "value": "footwear"},
        {"OR": [
          {"field": "price", "operator": "lte", "value": 100},
          {"field": "on_sale", "operator": "eq", "value": true}
        ]}
      ],
      "case_sensitive": false
    }
    ```
  </Tab>
  
  <Tab title="Available operators">
    <AccordionGroup>
      <Accordion title="Equality and ranges" icon="sliders">
        <code>eq</code>, <code>ne</code>, <code>gt</code>, <code>gte</code>, <code>lt</code>, <code>lte</code>
      </Accordion>
      <Accordion title="Sets" icon="list-check">
        <code>in</code>, <code>nin</code>
      </Accordion>
      <Accordion title="Text" icon="font">
        <code>contains</code>, <code>starts_with</code>, <code>ends_with</code>, <code>regex</code>, <code>text</code>
      </Accordion>
      <Accordion title="Presence" icon="eye">
        <code>exists</code>, <code>is_null</code>
      </Accordion>
      <Accordion title="Logical composition" icon="diagram-project">
        Top‑level: <code>AND</code>, <code>OR</code>, <code>NOT</code>; toggle case rules with <code>case_sensitive</code>
      </Accordion>
    </AccordionGroup>
  </Tab>
</Tabs>

## Manage retrievers

<CardGroup cols={2}>
  <Card title="Get Retriever" icon="magnifying-glass" href="/api-reference/retrievers/get-retriever" />
  <Card title="Delete Retriever" icon="trash" href="/api-reference/retrievers/delete-retriever" />
  <Card title="List Retrievers" icon="list" href="/api-reference/retrievers/list-retrievers" />
  <Card title="Debug Inference" icon="bug" href="/api-reference/retrievers/debug-inference" />
  <Card title="List Stages" icon="bars" href="/api-reference/retriever-stages/list-available-retriever-stages" />
</CardGroup>

## Best practices

<Steps>
  <Step title="Start simple">
    Begin with a single KNN stage; add hybrid, filters, and reranking as needed
  </Step>
  <Step title="Pre‑filter early">
    Narrow candidates with metadata filters before expensive vector ops
  </Step>
  <Step title="Select fields">
    Use <code>select</code> to minimize payload size and latency
  </Step>
  <Step title="Group wisely">
    Keep per‑group caps small to avoid skew
  </Step>
  <Step title="Version retrievers">
    Create new retrievers for breaking changes to inputs or stages
  </Step>
</Steps>

## See also

<CardGroup cols={2}>
  <Card title="Filters" icon="filter" href="/retrieval/filters">
    Operators and logical composition for queries
  </Card>
  
  <Card title="Interactions" icon="comments" href="/retrieval/interactions">
    Sessions, feedback, and iterative search flows
  </Card>
</CardGroup>

<CardGroup cols={2}>
  <Card title="Feature Extractors" icon="wand-magic-sparkles" href="/processing/feature-extractors">
    Configure features available to search
  </Card>
  
  <Card title="Collections" icon="database" href="/ingestion/collections">
    Target collections and describe searchable features
  </Card>
</CardGroup> 