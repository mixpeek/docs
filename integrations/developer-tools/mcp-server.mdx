---
title: "MCP Server"
description: "Connect Claude and AI assistants to Mixpeek via the Model Context Protocol"
---

The Mixpeek MCP server lets AI assistants like Claude manage your entire Mixpeek workflow — creating namespaces, uploading files, building search pipelines, and querying results — all through natural language.

<Info>
**What is MCP?** The [Model Context Protocol](https://modelcontextprotocol.io) is an open standard that lets AI assistants connect to external tools and data sources. Instead of copy-pasting API calls, you describe what you want and Claude handles the rest.
</Info>

## Two Servers, Two Use Cases

Mixpeek provides two MCP servers for different scenarios:

<CardGroup cols={2}>
  <Card title="Full Platform Server" icon="layer-group">
    **43 tools** covering every Mixpeek operation. Use this when you need to manage your entire Mixpeek setup — namespaces, buckets, collections, retrievers, taxonomies, and more.

    Best for: building pipelines, managing resources, exploring your data
  </Card>
  <Card title="Retriever Server" icon="magnifying-glass">
    **3 focused tools** scoped to a single retriever. Dynamically generates a `search` tool whose input schema matches your retriever's configuration — so Claude knows exactly what parameters to pass.

    Best for: embedding search into AI apps, agents, or workflows
  </Card>
</CardGroup>

---

## Full Platform Server

### Setup

Add to your Claude Desktop or Claude Code config:

<CodeGroup>

```json Claude Desktop
// macOS: ~/Library/Application Support/Claude/claude_desktop_config.json
// Windows: %APPDATA%\Claude\claude_desktop_config.json
{
  "mcpServers": {
    "mixpeek": {
      "url": "https://mcp.mixpeek.com",
      "headers": {
        "Authorization": "Bearer YOUR_API_KEY"
      }
    }
  }
}
```

```json Claude Code
// .claude/settings.json or ~/.claude/settings.json
{
  "mcpServers": {
    "mixpeek": {
      "url": "https://mcp.mixpeek.com",
      "headers": {
        "Authorization": "Bearer YOUR_API_KEY"
      }
    }
  }
}
```

</CodeGroup>

Replace `YOUR_API_KEY` with your key from the [Mixpeek dashboard](https://mixpeek.com/dashboard).

### Available Tools (43)

<AccordionGroup>
  <Accordion title="Namespace Management" icon="folder" defaultOpen>
    Namespaces are isolated workspaces. Each namespace maps to its own vector collection in Qdrant.

    | Tool | Description |
    |------|-------------|
    | `create_namespace` | Create a new workspace with feature extractors |
    | `list_namespaces` | List all namespaces in your organization |
    | `get_namespace` | Get namespace details by ID or name |
    | `update_namespace` | Update namespace configuration |
    | `delete_namespace` | Delete a namespace and all its resources |
  </Accordion>

  <Accordion title="Bucket Management" icon="bucket">
    Buckets store your raw files (videos, images, documents) before processing.

    | Tool | Description |
    |------|-------------|
    | `create_bucket` | Create a file storage bucket |
    | `list_buckets` | List all buckets in a namespace |
    | `get_bucket` | Get bucket details |
    | `update_bucket` | Update bucket configuration |
    | `delete_bucket` | Delete a bucket and its objects |
    | `upload_object` | Upload a file from a URL |
  </Accordion>

  <Accordion title="Collection Management" icon="layer-group">
    Collections define how your data is processed — which feature extractors run, what embeddings are generated.

    | Tool | Description |
    |------|-------------|
    | `create_collection` | Create a collection with feature extractors |
    | `list_collections` | List all collections in a namespace |
    | `get_collection` | Get collection details |
    | `update_collection` | Update collection configuration |
    | `clone_collection` | Clone an existing collection |
    | `trigger_collection` | Trigger the processing pipeline |
    | `delete_collection` | Delete a collection and its documents |
  </Accordion>

  <Accordion title="Document Management" icon="file">
    Documents are the processed records stored in your namespace with extracted features and embeddings.

    | Tool | Description |
    |------|-------------|
    | `create_document` | Add a document to a collection |
    | `list_documents` | Query documents with filters |
    | `get_document` | Get a document by ID |
    | `update_document` | Update document fields |
    | `delete_document` | Delete a document |
  </Accordion>

  <Accordion title="Retriever Management" icon="filter">
    Retrievers are multi-stage search pipelines. Chain stages together to search, filter, rerank, and enrich results.

    | Tool | Description |
    |------|-------------|
    | `create_retriever` | Create a multi-stage search pipeline |
    | `list_retrievers` | List all retrievers |
    | `get_retriever` | Get retriever configuration and stages |
    | `update_retriever` | Update retriever metadata |
    | `clone_retriever` | Clone an existing retriever |
    | `execute_retriever` | Run the search pipeline with inputs |
    | `delete_retriever` | Delete a retriever |

    **23 available stages** across 5 categories:

    | Category | Stages |
    |----------|--------|
    | **Filter** | `feature_search`, `attribute_filter`, `llm_filter`, `query_expand`, `agent_search` |
    | **Sort** | `sort_relevance`, `sort_attribute`, `rerank`, `mmr`, `score_normalize` |
    | **Reduce** | `group_by`, `aggregate`, `cluster`, `sample`, `summarize`, `limit`, `deduplicate` |
    | **Apply** | `json_transform`, `api_call`, `external_web_search`, `sql_lookup`, `code_execution`, `cross_compare`, `rag_prepare`, `unwind` |
    | **Enrich** | `document_enrich`, `taxonomy_enrich`, `llm_enrich`, `web_scrape` |
  </Accordion>

  <Accordion title="Taxonomy Management" icon="sitemap">
    Taxonomies are hierarchical classification systems you can apply to documents.

    | Tool | Description |
    |------|-------------|
    | `create_taxonomy` | Create a classification hierarchy |
    | `list_taxonomies` | List all taxonomies |
    | `get_taxonomy` | Get taxonomy details |
    | `execute_taxonomy` | Classify documents with a taxonomy |
    | `delete_taxonomy` | Delete a taxonomy |
  </Accordion>

  <Accordion title="Cluster Management" icon="circle-nodes">
    Clusters group similar documents together for discovery and organization.

    | Tool | Description |
    |------|-------------|
    | `create_cluster` | Create a clustering configuration |
    | `list_clusters` | List all clusters |
    | `execute_cluster` | Run the clustering algorithm |
    | `delete_cluster` | Delete a cluster |
  </Accordion>

  <Accordion title="Agent & Search" icon="robot">
    Conversational AI sessions and global search.

    | Tool | Description |
    |------|-------------|
    | `create_agent_session` | Start a conversational AI session |
    | `send_agent_message` | Send a message to an agent |
    | `get_agent_history` | Get conversation history |
    | `search_namespace` | Search across all resources in a namespace |
  </Accordion>
</AccordionGroup>

### Examples

**Create a collection and process videos:**
```
"Create a collection called 'product-demos' with the multimodal extractor
for scene detection and transcription, then upload this video URL to it"
```

**Build a search pipeline:**
```
"Create a retriever called 'demo-search' that does a feature search on
my product-demos collection, reranks the top 50 down to 10 with Cohere,
and adds a 2-sentence summary using GPT-4"
```

**Query your data:**
```
"Search for product demos about the new dashboard feature"
```

---

## Retriever Server

The Retriever MCP server is a lightweight server scoped to a **single retriever**. It reads your retriever's `input_schema` at startup and generates a typed `search` tool whose parameters match exactly — so the AI assistant knows what inputs are available without any guesswork.

### Tools

| Tool | Description |
|------|-------------|
| `search` | Execute the retriever. Parameters are generated from the retriever's `input_schema` — including the correct field names, types, required flags, enums, and descriptions. Pagination parameters (`page`, `page_size`) are added automatically. |
| `describe` | Returns structured metadata: retriever ID, name, collections, input fields, and stage configuration. |
| `explain` | Returns a human-readable explanation of the pipeline: what each stage does, in what order. |

### How Dynamic Schema Works

When the server starts, it fetches your retriever's configuration and converts its `input_schema` into a JSON Schema for the `search` tool. For example, if your retriever has:

```json
{
  "input_schema": {
    "query": { "type": "text", "required": true, "description": "Search query" },
    "category": {
      "type": "string",
      "required": false,
      "enum": ["electronics", "clothing", "home"],
      "description": "Filter by category"
    }
  }
}
```

The `search` tool will expose `query` (required string) and `category` (optional enum) as typed parameters — plus `page` and `page_size` for pagination.

<Note>
If your retriever's `input_schema` has a field named `page` or `page_size`, the pagination parameters are automatically renamed to `_pagination_page` and `_pagination_page_size` to avoid conflicts.
</Note>

### Setup

<Tabs>
  <Tab title="Claude Desktop (stdio)">
    ```json
    {
      "mcpServers": {
        "my-search": {
          "command": "mixpeek-mcp-retriever",
          "args": [
            "--retriever-id", "ret_abc123",
            "--namespace-id", "ns_xyz789",
            "--api-key", "YOUR_API_KEY"
          ]
        }
      }
    }
    ```

    Requires the `mixpeek-mcp-retriever` CLI installed:
    ```bash
    pip install mixpeek  # includes the CLI
    ```
  </Tab>
  <Tab title="HTTP (deployed)">
    Run the server as an HTTP endpoint for remote access:

    ```bash
    mixpeek-mcp-retriever \
      --retriever-id ret_abc123 \
      --namespace-id ns_xyz789 \
      --api-key YOUR_API_KEY \
      --transport http \
      --port 8081
    ```

    Then connect your MCP client to `http://your-host:8081`.

    **HTTP Endpoints:**

    | Method | Path | Description |
    |--------|------|-------------|
    | `GET` | `/health` | Health check with retriever info |
    | `GET` | `/tools` | List all 3 tools with schemas |
    | `POST` | `/tools/call` | Execute a tool (requires `Authorization` header) |
  </Tab>
  <Tab title="Environment Variables">
    All settings can be configured via environment variables (prefixed with `RETRIEVER_MCP_`):

    ```bash
    export RETRIEVER_MCP_RETRIEVER_ID=ret_abc123
    export RETRIEVER_MCP_NAMESPACE_ID=ns_xyz789
    export RETRIEVER_MCP_API_KEY=YOUR_API_KEY
    export RETRIEVER_MCP_TRANSPORT=stdio   # or "http"
    export RETRIEVER_MCP_HTTP_PORT=8081
    ```

    Then just run `mixpeek-mcp-retriever` with no arguments.
  </Tab>
</Tabs>

### Example Conversation

Once connected, you can interact naturally:

```
You: "What does this retriever do?"
Claude: [calls describe] → "This is 'Product Search' — it searches your
products collection by text query with an optional category filter,
using feature search → attribute filter → reranking."

You: "Search for wireless headphones under electronics"
Claude: [calls search with query="wireless headphones", category="electronics"]
→ Returns top 10 matching products with scores and metadata.

You: "Explain the pipeline stages"
Claude: [calls explain] → "1. feature_search: embeds your query and finds
the top 50 matches. 2. attribute_filter: filters by category field.
3. rerank: reranks with Cohere down to the top 10."
```

---

## Authentication & Security

Both MCP servers use your existing Mixpeek API key with the same permissions as the REST API.

- All requests authenticated via API key
- Same RBAC permissions as the REST API
- Rate limiting per organization
- Audit logging for all operations
- TLS encryption on the hosted server

<Warning>
**Keep your API key secure.** Never commit keys to version control. For the Retriever Server, prefer environment variables over CLI arguments in production.
</Warning>

## Architecture

```
┌─────────────────────┐
│   Claude / AI App   │
└──────────┬──────────┘
           │ MCP Protocol
           │
     ┌─────┴──────┐
     │            │
     ▼            ▼
┌──────────┐  ┌──────────────┐
│ Full     │  │ Retriever    │
│ Platform │  │ Server       │
│ Server   │  │ (per-retriever)│
│ 43 tools │  │ 3 tools      │
└────┬─────┘  └──────┬───────┘
     │               │
     └───────┬───────┘
             │ Direct service calls
             ▼
     ┌───────────────┐
     │ Mixpeek       │
     │ Services      │
     │ (MongoDB,     │
     │  Qdrant,      │
     │  Redis, S3)   │
     └───────────────┘
```

**Full Platform Server** — Hosted at `https://mcp.mixpeek.com`. Connect with just a URL and API key. Covers all operations.

**Retriever Server** — Runs locally (stdio) or as a deployed HTTP service. Scoped to one retriever with a dynamically typed search tool. Ideal for embedding a specific search capability into an AI agent or workflow.

## Troubleshooting

<AccordionGroup>
  <Accordion title="Claude can't connect to the MCP server">
    - Verify the URL is `https://mcp.mixpeek.com` (full platform) or your Retriever Server host
    - Check that the `Authorization` header format is `Bearer YOUR_API_KEY`
    - Restart Claude Desktop or Claude Code after changing config
  </Accordion>

  <Accordion title="Tools return 'Unauthorized' or 'Invalid API key'">
    - Verify your API key at [mixpeek.com/dashboard](https://mixpeek.com/dashboard)
    - Check that the key has permissions for the namespace you're accessing
    - Make sure there are no extra spaces in the key
  </Accordion>

  <Accordion title="Retriever Server fails to start">
    - Ensure `--retriever-id` and `--namespace-id` are correct
    - Verify the API key has access to that namespace
    - Check that the retriever exists: `GET /v1/retrievers/{id}`
  </Accordion>

  <Accordion title="Search returns empty results">
    - Confirm your collection has processed documents (not just uploaded files)
    - Check that the retriever's `feature_uri` matches your collection's extractor
    - Try a broader query or remove optional filters
  </Accordion>

  <Accordion title="Slow response times">
    - Large file uploads depend on file size and network
    - Multi-stage retrievers with LLM enrichment or reranking take more time
    - Check [status.mixpeek.com](https://status.mixpeek.com) for service issues
  </Accordion>
</AccordionGroup>

## Next Steps

<CardGroup cols={2}>
  <Card title="Core Concepts" icon="book" href="/overview/concepts">
    Understand namespaces, collections, and documents
  </Card>
  <Card title="Feature Extractors" icon="microchip" href="/processing/feature-extractors">
    Choose the right extractor for your data
  </Card>
  <Card title="Retriever Stages" icon="filter" href="/retrieval/stages/overview">
    Learn what each pipeline stage does
  </Card>
  <Card title="API Reference" icon="code" href="/api-reference">
    Full REST API documentation
  </Card>
</CardGroup>
